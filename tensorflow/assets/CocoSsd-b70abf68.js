import{hM as Vs,hN as Es,l as Os,hO as Ps,hP as Ws,m as ut,cd as As,ce as $s,cf as We,cb as zs,fE as Hs,fF as Ls,a7 as ne,fG as zt,fI as Ke,a5 as tt,cg as Ae,fK as _s,F as Bs,E as B,D as ue,a3 as K,fM as ft,hQ as se,gO as Bt,gc as yt,hR as Gs,a1 as It,I as qs,hS as js,ah as Us,hT as Ks,gd as pe,a0 as ae,G as Xe,$ as dt,ai as Ye,aA as Ze,aB as Qe,dd as Je,aF as tn,aO as en,aP as nn,aS as sn,aT as an,aU as on,a_ as rn,b2 as cn,b4 as ln,b5 as Xs,gw as we,b9 as dn,K as Ys,bh as Zs,L as mt,M as Nt,N as wt,R as Wt,Q as Tt,g4 as Qt,hU as Qs,hV as Js,hW as ta,hX as ea,t as na,x as sa,e4 as aa,hY as oa,bt as un,bx as pn,a9 as ra,aa as ia,hZ as ca,a2 as la,a4 as da,a6 as ua,bE as pa,bD as fa,bC as ha,bJ as ma,bI as ga,bK as Ia,bH as ka,bG as ba,bL as $e,bO as xa,bN as ya,bM as Sa,bT as fn,bV as hn,a8 as Na,c1 as mn,h_ as Kt,g0 as pt,ci as wa,az as gn,aR as va,bg as Ca,bl as In,bm as kn,X as Ta,Y as Ma,Z as Fa,C as Ra,ct as bn,cw as xn,H as Da,O as Va,P as At,S as Ea,U as Oa,cA as Pa,cB as yn,cC as Sn,cE as Nn,cD as wn,cF as vn,V as Wa,d5 as ve,W as Jt,fg as Ce,cL as Aa,fT as fe,cK as $a,cM as za,aH as Ha,ab as La,ac as Cn,ad as Tn,ae as Mn,af as _a,ag as Ba,fV as Ga,fX as qa,aj as Fn,cU as ja,fY as Ua,ak as Ka,al as Xa,am as ke,an as Ya,ao as Te,ap as Gt,g1 as Za,aq as Qa,c$ as Ja,g2 as Me,c_ as to,g3 as eo,ar as Rn,as as Dn,at as no,au as so,g5 as ao,av as Vn,aw as oo,g6 as ro,ax as io,ay as co,g8 as lo,g9 as uo,ga as po,d8 as fo,gb as Fe,da as ze,ge as $t,gf as En,d9 as He,c2 as ho,gi as mo,gj as go,gk as Io,gl as ko,gm as bo,gn as xo,db as yo,dc as On,gp as So,gq as No,gr as wo,gs as vo,gt as Co,gu as To,aC as Mo,bj as Pn,gv as Wn,gx as Fo,gy as Ro,gz as Do,gA as Vo,gC as Eo,gD as Oo,gE as Po,aD as Wo,gF as Ao,aE as $o,aG as An,aI as zo,aJ as Ho,aK as Lo,aL as _o,aM as Bo,aN as Go,gI as qo,dh as $n,di as zn,aQ as Hn,gJ as jo,dk as Ln,aV as _n,aW as Bn,aX as Gn,dn as Uo,dm as Ko,aZ as Xo,a$ as Yo,ds as Zo,dr as Qo,dt as Jo,gN as tr,b0 as er,b1 as nr,b3 as sr,dv as qn,bz as ar,gQ as or,gR as rr,b6 as ir,gS as cr,b7 as lr,gT as dr,b8 as ur,gU as pr,ba as fr,c9 as hr,bb as mr,bc as gr,bd as Ir,be as kr,bf as jn,gV as br,gZ as xr,bi as yr,bk as Un,bn as Sr,dB as Nr,bo as wr,dC as vr,bp as Cr,bq as Tr,br as Mr,bs as Kn,bu as Fr,bv as Xn,h1 as Rr,bw as Dr,dF as Yn,dG as Vr,dH as Er,dI as Zn,by as Qn,dK as Jn,dM as ts,bA as Or,bB as Pr,bF as Wr,bP as Ar,bQ as $r,h5 as zr,bR as Hr,bS as Lr,bU as _r,bW as es,bX as Br,bY as Gr,bZ as qr,b_ as jr,b$ as Ur,c0 as Kr,c3 as ns,c4 as ss,c5 as Xr,c6 as Yr,c7 as Zr,hd as Re,he as Qr,c8 as Jr,dO as ti,ca as ei,h$ as as,i0 as ni,c as si,_ as ai}from"./register_all_kernels-44fb38c1.js";import{u as oi}from"./useCanvas-4c9bfa50.js";import{u as ri}from"./useVideo-1d9327e0.js";import{d as ii,f as be,h as ci,c as Le,i as xe,u as ye,t as li,j as di,o as _e}from"./index-761e0eed.js";/** @license See the LICENSE file. */const ui="4.4.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pi=Object.freeze(Object.defineProperty({__proto__:null,GraphModel:Vs,deregisterOp:Es,loadGraphModel:Os,loadGraphModelSync:Ps,registerOp:Ws,version_converter:ui},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G(o,s){Array.isArray(o)||(o=[o]),o.forEach(t=>{t!=null&&ut(t.dtype!=="complex64",()=>`${s} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fi=_s;class he extends As{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new $s(this,We())}nextDataId(){return he.nextDataId++}write(s,t,n){this.firstUse&&(this.firstUse=!1,zs().get("IS_NODE")&&Hs(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const e={id:this.nextDataId()};return this.data.set(e,{values:s,dtype:n,refCount:1}),e}makeTensorInfo(s,t,n){let e;if(t==="string"&&n!=null&&n.length>0&&Ls(n[0])){const a=n.map(i=>ne(i));e=this.write(a,s,t)}else e=this.write(n,s,t);return{dataId:e,shape:s,dtype:t}}refCount(s){return this.data.has(s)?this.data.get(s).refCount:0}incRef(s){const t=this.data.get(s);t.refCount++}decRef(s){if(this.data.has(s)){const t=this.data.get(s);t.refCount--}}move(s,t,n,e,a){this.data.set(s,{values:t,dtype:e,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(s){return this.readSync(s)}readSync(s){const{dtype:t,complexTensorInfos:n}=this.data.get(s);if(t==="complex64"){const e=this.readSync(n.real.dataId),a=this.readSync(n.imag.dataId);return zt(e,a)}return this.data.get(s).values}bufferSync(s){const t=this.readSync(s.dataId);if(s.dtype==="string")try{const n=t.map(e=>Ke(e));return tt(s.shape,s.dtype,n)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return tt(s.shape,s.dtype,t)}makeOutput(s,t,n){return We().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,s),this)}disposeData(s,t=!1){if(this.data.has(s)){if(this.data.get(s).refCount--,!t&&this.data.get(s).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(s);n!=null&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(s)}return!0}disposeIntermediateTensorInfo(s){this.disposeData(s.dataId)}async time(s){const t=Ae();return s(),{kernelMs:Ae()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(s){G([s],"where");const t=this.readSync(s.dataId);return fi(s.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}he.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hi(o){const s=new Float32Array(o.length);for(let t=0;t<o.length;++t)s[t]=Math.abs(o[t]);return s}const mi=o=>{const{x:s}=o.inputs,t=o.backend;G(s,"abs");let n=new Float32Array(B(s.shape));const e=t.data.get(s.dataId).values;return n=hi(e),t.makeOutput(n,s.shape,s.dtype)},gi={kernelName:Bs,backendName:"cpu",kernelFunc:mi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function it(o){return(s,t,n,e,a)=>{const i=ue(s,t),c=i.length,r=K(i),l=B(i),d=ft(a,l),u=s.length,p=t.length,f=K(s),m=K(t),g=se(s,i),h=se(t,i);if(g.length+h.length===0)for(let I=0;I<d.length;++I)d[I]=o(n[I%n.length],e[I%e.length]);else for(let I=0;I<d.length;++I){const k=Bt(I,c,r),x=k.slice(-u);g.forEach(N=>x[N]=0);const b=yt(x,u,f),y=k.slice(-p);h.forEach(N=>y[N]=0);const S=yt(y,p,m);d[I]=o(n[b],e[S])}return[d,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gt(o){const{inputs:s,backend:t}=o,{real:n,imag:e}=s,a=t.data.get(n.dataId).values,i=t.data.get(e.dataId).values,c=t.makeTensorInfo(n.shape,"complex64"),r=t.data.get(c.dataId);return r.complexTensorInfos={real:t.makeTensorInfo(n.shape,"float32",a),imag:t.makeTensorInfo(e.shape,"float32",i)},c}const Ii={kernelName:Gs,backendName:"cpu",kernelFunc:gt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oe(o,s,t="float32"){if(t==="complex64"){const e=oe(o,s,"float32"),a=oe(o,s,"float32");return gt({inputs:{real:e,imag:a},backend:o})}const n=It(B(s),t);return o.makeTensorInfo(s,t,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function St(o){const{inputs:s,backend:t}=o,{x:n}=s;return t.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const ki={kernelName:qs,backendName:"cpu",kernelFunc:St};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ot(o){const{inputs:s,backend:t}=o,{input:n}=s,e=t.data.get(n.dataId).complexTensorInfos.real,a=t.data.get(e.dataId).values;return t.makeTensorInfo(e.shape,e.dtype,a)}const bi={kernelName:js,backendName:"cpu",kernelFunc:Ot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xi(o,s,t,n){if(n==="int32"){const e=Int32Array.from(o);return[s,"int32",e]}if(n==="bool"){const e=pe([0],t),[a,i]=it((c,r)=>c!==r?1:0)(s,[],o,e,"bool");return[i,"bool",a]}throw new Error(`Error in Cast: failed to cast ${t} to ${n}`)}function Vt(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{dtype:a}=n;if(a==="complex64"){if(e.dtype==="complex64")return St({inputs:{x:e},backend:t});const d=oe(t,e.shape,e.dtype),u=Vt({inputs:{x:e},backend:t,attrs:{dtype:"float32"}}),p=gt({inputs:{real:u,imag:d},backend:t});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(u),p}if(e.dtype==="complex64"){const d=Ot({inputs:{input:e},backend:t}),u=Vt({inputs:{x:d},backend:t,attrs:{dtype:a}});return t.disposeIntermediateTensorInfo(d),u}if(!Ks(e.dtype,a)){const d=St({inputs:{x:e},backend:t});return{dataId:d.dataId,shape:d.shape,dtype:a}}const i=t.data.get(e.dataId).values,[c,r,l]=xi(i,e.shape,e.dtype,a);return t.makeTensorInfo(c,r,l)}const yi={kernelName:Us,backendName:"cpu",kernelFunc:Vt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ct(o,s,t,n){return t==null?({inputs:e,backend:a})=>{const{a:i,b:c}=e,r=a;G([i,c],o);const l=r.data.get(i.dataId).values,d=r.data.get(c.dataId).values,u=i.dtype==="string"?ae(l):l,p=i.dtype==="string"?ae(d):d,f=n||i.dtype,[m,g]=s(i.shape,c.shape,u,p,f);return r.makeTensorInfo(g,f,m)}:({inputs:e,backend:a})=>{const{a:i,b:c}=e,r=a;if(i.dtype==="complex64"||c.dtype==="complex64"){const l=Vt({inputs:{x:i},backend:r,attrs:{dtype:"complex64"}}),d=r.data.get(l.dataId),u=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,f=r.data.get(u.dataId).values,m=r.data.get(p.dataId).values,g=Vt({inputs:{x:c},backend:r,attrs:{dtype:"complex64"}}),h=r.data.get(g.dataId),I=h.complexTensorInfos.real,k=h.complexTensorInfos.imag,x=r.data.get(I.dataId).values,b=r.data.get(k.dataId).values,[y,S,N]=t(i.shape,c.shape,f,m,x,b),w=r.makeTensorInfo(N,"float32",y),F=r.makeTensorInfo(N,"float32",S),R=gt({inputs:{real:w,imag:F},backend:r});return r.disposeIntermediateTensorInfo(l),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(F),R}else{const l=r.data.get(i.dataId).values,d=r.data.get(c.dataId).values,u=n||i.dtype,[p,f]=s(i.shape,c.shape,l,d,u);return r.makeTensorInfo(f,u,p)}}}function De(o){return(s,t,n,e,a,i)=>{const c=ue(s,t),r=B(c),l=c.length,d=K(c),u=ft("float32",r),p=ft("float32",r),f=se(s,c),m=se(t,c),g=zt(n,e),h=zt(a,i),I=s.length,k=K(s),x=t.length,b=K(t);if(f.length+m.length===0)for(let y=0;y<u.length;y++){const S=y%g.length,N=y%h.length,w=o(g[S*2],g[S*2+1],h[N*2],h[N*2+1]);u[y]=w.real,p[y]=w.imag}else for(let y=0;y<u.length;y++){const S=Bt(y,l,d),N=S.slice(-I);f.forEach(P=>N[P]=0);const w=yt(N,I,k),F=S.slice(-x);m.forEach(P=>F[P]=0);const R=yt(F,x,b),E=o(g[w*2],g[w*2+1],h[R*2],h[R*2+1]);u[y]=E.real,p[y]=E.imag}return[u,p,c]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Si=it((o,s)=>o+s),Ni=De((o,s,t,n)=>({real:o+t,imag:s+n})),Ht=ct(Xe,Si,Ni),wi={kernelName:Xe,backendName:"cpu",kernelFunc:Ht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function os(o,s,t,n,e){const a=B(n),i=It(e,t);for(let c=0;c<o.length;c++){const r=o[c];if(r<0)throw new Error("Input x must be non-negative!");r>=e||(a>0?i[r]+=s[c]:i[r]+=1)}return i}function vi(o,s,t,n=!1){const e=o.shape[0],a=o.shape[1],i=tt([e,t],s.dtype);for(let c=0;c<e;c++)for(let r=0;r<a;r++){const l=o.get(c,r);if(l<0)throw new Error("Input x must be non-negative!");l>=t||(n?i.set(1,c,l):s.size>0?i.set(i.get(c,l)+s.get(c,r),c,l):i.set(i.get(c,l)+1,c,l))}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qt(o){return(s,t,n)=>{const e=ft(t,s.length);for(let a=0;a<s.length;++a)e[a]=o(s[a],n);return e}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q(o,s,t){return({inputs:n,attrs:e,backend:a})=>{const{x:i}=n;if(G(i,o),i.dtype==="string"||t==="string")throw new Error("unaryKernelFunc does not support string input/output");const c=a,r=c.data.get(i.dataId).values,l=B(i.shape),d=t||i.dtype,u=dt(d,l);for(let p=0;p<l;++p)u[p]=s(r[p],e);return c.makeTensorInfo(i.shape,d,u)}}function jt(o,s,t){return({inputs:n,attrs:e,backend:a})=>{const{x:i}=n;if(G(i,o),i.dtype==="string"||t==="string")throw new Error("unaryKernelFunc does not support string input/output");const c=a,r=c.data.get(i.dataId).values,l=t||i.dtype,d=s(r,l,e);return c.makeTensorInfo(i.shape,l,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ci=qt(o=>Math.ceil(o)),Ti=jt(Ye,Ci),Mi={kernelName:Ye,backendName:"cpu",kernelFunc:Ti};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fi(o,s,t,n){const e=dt(t,B(s));if(n&&t!=="string"){let a=0;o.forEach(i=>{const c=B(i.shape);e.set(i.vals,a),a+=c})}else{let a=0;o.forEach(i=>{const c=t==="string"?ae(i.vals):i.vals;let r=0;for(let l=0;l<i.shape[0];++l){const d=l*s[1]+a;for(let u=0;u<i.shape[1];++u)e[d+u]=c[r++]}a+=i.shape[1]})}return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ri=it((o,s)=>o===s?1:0),rs=ct(Ze,Ri,null,"bool"),Di={kernelName:Ze,backendName:"cpu",kernelFunc:rs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vi=qt(o=>Math.exp(o)),is=jt(Qe,Vi,"float32"),Ei={kernelName:Qe,backendName:"cpu",kernelFunc:is};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oi=qt(o=>Math.expm1(o)),Pi=jt(Je,Oi),Wi={kernelName:Je,backendName:"cpu",kernelFunc:Pi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ai=qt(o=>Math.floor(o)),$i=jt(tn,Ai),zi={kernelName:tn,backendName:"cpu",kernelFunc:$i};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hi(o,s,t,n,e,a,i,c,r){const l=tt([n,a],t);for(let d=0;d<n;d++){const u=[];let p=0;for(let f=0;f<e;f++){const m=o[d*e+f];p+=m*i[f],u.push(m)}if(p<0||p>=r/a)throw new Error(`Invalid indices: ${u} does not index into ${c}`);for(let f=0;f<a;f++)l.values[d*a+f]=s.get(...s.indexToLoc(p*a+f))}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Li(o,s,t){const n=tt(t,o.dtype);for(let e=0;e<n.size;++e){const i=n.indexToLoc(e).slice(),c=i[0],r=i[2],l=s.locToIndex([c,r]);i[2]=s.values[l];const d=o.locToIndex(i);0<=d&&d<o.values.length&&(n.values[e]=o.values[d])}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _i=it((o,s)=>o>s?1:0),Bi=ct(en,_i,null,"bool"),Gi={kernelName:en,backendName:"cpu",kernelFunc:Bi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qi=it((o,s)=>o>=s?1:0),ji=ct(nn,qi,null,"bool"),Ui={kernelName:nn,backendName:"cpu",kernelFunc:ji};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ki=it((o,s)=>o<s?1:0),Xi=ct(sn,Ki,null,"bool"),Yi={kernelName:sn,backendName:"cpu",kernelFunc:Xi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zi=it((o,s)=>o<=s?1:0),Qi=ct(an,Zi,null,"bool"),Ji={kernelName:an,backendName:"cpu",kernelFunc:Qi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tc(o,s,t){const n=(s-o)/(t-1),e=It(t,"float32");e[0]=o;for(let a=1;a<e.length;a++)e[a]=e[a-1]+n;return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ec=qt(o=>Math.log(o)),nc=jt(on,ec),sc={kernelName:on,backendName:"cpu",kernelFunc:nc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ac(o,s,t,n){const e=ft(n,B(t));for(let a=0;a<e.length;++a){const i=a*s;let c=o[i];for(let r=0;r<s;++r){const l=o[i+r];(Number.isNaN(l)||l>c)&&(c=l)}e[a]=c}return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oc=it((o,s)=>Math.max(o,s)),rc=ct(rn,oc),ic={kernelName:rn,backendName:"cpu",kernelFunc:rc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cc=it((o,s)=>Math.min(o,s)),lc=ct(cn,cc),dc={kernelName:cn,backendName:"cpu",kernelFunc:lc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cs=it((o,s)=>o*s),uc=De((o,s,t,n)=>({real:o*t-s*n,imag:o*n+s*t})),me=ct(ln,cs,uc),pc={kernelName:ln,backendName:"cpu",kernelFunc:me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fc(o,s,t){const n=we(-1,t);return cs([],s,n,o,t)}function hc(o){const{inputs:s,backend:t}=o,{x:n}=s;G(n,"neg");const e=t.data.get(n.dataId).values,[a,i]=fc(e,n.shape,n.dtype);return t.makeTensorInfo(i,n.dtype,a)}const mc={kernelName:Xs,backendName:"cpu",kernelFunc:hc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gc=it((o,s)=>o!==s?1:0),Ic=ct(dn,gc,null,"bool"),kc={kernelName:dn,backendName:"cpu",kernelFunc:Ic};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ls(o,s,t,n,e){const a=s.length,i=B(s),c=K(s),r=K(e),l=ft(t,B(e));for(let d=0;d<i;++d){const u=Bt(d,a,c),p=new Array(u.length);for(let m=0;m<p.length;m++)p[m]=u[n[m]];const f=yt(p,a,r);l[f]=o[d]}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ht(o){const{inputs:s,attrs:t,backend:n}=o,{x:e}=s,{perm:a}=t;G(e,"transpose");const i=e.shape.length,c=new Array(i);for(let u=0;u<c.length;u++)c[u]=e.shape[a[u]];const r=n.data.get(e.dataId).values,l=ls(r,e.shape,e.dtype,a,c);return{dataId:n.write(l,c,e.dtype),shape:c,dtype:e.dtype}}const bc={kernelName:Ys,backendName:"cpu",kernelFunc:ht};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xc(o,s,t,n){const[e,a]=Tt(o,n),i=Qt(s,"int32"),c=It(B(e),i),r=B(a);for(let l=0;l<c.length;++l){const d=l*r;let u=1;for(let p=0;p<r;++p)u*=t[d+p];c[l]=u}return{outVals:c,outShape:e,outDtype:i}}function yc(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{axis:a,keepDims:i}=n;G(e,"prod");const c=e.shape.length,r=mt(a,e.shape),l=Nt(r,c);let d=r,u=e;const p=[];l!=null&&(u=ht({inputs:{x:e},backend:t,attrs:{perm:l}}),p.push(u),d=wt(d.length,c));const f=t.data.get(u.dataId).values,{outVals:m,outShape:g,outDtype:h}=xc(u.shape,u.dtype,f,d);let I=g;return i&&(I=Wt(g,r)),p.forEach(k=>t.disposeIntermediateTensorInfo(k)),t.makeTensorInfo(I,h,m)}const Sc={kernelName:Zs,backendName:"cpu",kernelFunc:yc};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nc(o,s,t){o.forEach((n,e)=>{if(n<0||n>=t){const a=Bt(e,s.length,K(s)).join(",");throw new Error(`indices[${a}] = ${n} is not in [0, ${t})`)}})}function wc(o,s){for(let t=0;t<o.length;++t){const n=o[t],e=t===o.length-1?s:o[t+1].length;if(n.length===0)throw new Error("Ragged splits may not be empty");if(n[0]<0)throw new Error("Ragged splits must be non-negative");if(n[n.length-1]>e)throw new Error("Ragged splits must not point past values");for(let a=1;a<n.length;++a)if(n[a-1]>n[a])throw new Error("Ragged splits must be sorted in ascending order")}}function vc(o,s,t,n){const e=[];let a=0;const i=s.length-1+t.length,c=new Array(i).fill(null).map(()=>[0]);wc(t,n);let r=1;for(let l=0;l<s.length-1;++l){r*=s[l];const d=s[l+1];for(let u=1;u<r+1;++u)c[l].push(u*d)}for(let l=0;l<o.length;++l){let d=o[l],u=o[l]+1;for(let p=0;p<t.length;++p){const f=t[p],m=p+s.length-1;if(m>=0){const g=c[m],h=g[g.length-1]-f[d];for(let I=d;I<u;++I)c[m].push(f[I+1]+h)}d=f[d],u=f[u]}u!==d&&(e.push([d,u]),a+=u-d)}return{outSplits:c,valueSlices:e,numValues:a}}function Cc(o){const s=[];for(let t=0;t<o.length;++t){const n=o[t].length,e=dt("int32",n);s.push(e),o[t].forEach((a,i)=>e[i]=a)}return s}function Be(o,s){const t=o.slice(0,s);for(;t.length<s;)t.push(1);for(let n=s;n<o.length;n++)t[s-1]*=o[n];return t}function Tc(o,s,t,n,e,a){const i=Be(s,2)[1],c=Be(a,2)[1];let r=0;for(const l of t)for(let d=l[0];d<l[1];++d){for(let u=0;u<n;++u)e[r*c+u]=o[d*i+u];++r}}function Mc(o,s,t,n,e){const a=s.slice();a[0]=e;const i=dt(t,B(a)),c=o.length,r=c===0?0:c/s[0];return Tc(o,s,n,r,i,a),[i,a]}function Fc(o,s,t,n,e,a,i,c){if(o.length===0)throw new Error("paramsNestedSplits must be non empty");if(s[0].length===0)throw new Error("Split tensors must not be scalars");const r=s[0][0]-1;if(Nc(a,i,r),n.length===0)throw new Error("params.rank must be nonzero");const l=n[0],{outSplits:d,valueSlices:u,numValues:p}=vc(a,i,o,l),f=Cc(d),m=Mc(t,n,e,u,p);return[f,m[0],m[1]]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bt=oa;class re{constructor(s,t,n,e,a,i,c,r,l,d){this.shape=s,this.shapeShape=t,this.values=n,this.valuesShape=e,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=c,this.rowPartitionValues=r,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=Qs(d),this.raggedRank=Js(this.rowPartitionTypes)}getRowPartitionTypeByDimension(s){return this.rowPartitionTypes[0]===bt.FIRST_DIM_SIZE?this.rowPartitionTypes[s+1]:this.rowPartitionTypes[s]}getRowPartitionTensor(s){return this.rowPartitionTypes[0]===bt.FIRST_DIM_SIZE?this.rowPartitionValues[s+1]:this.rowPartitionValues[s]}getMaxWidth(s){const t=this.getRowPartitionTensor(s-1);switch(this.getRowPartitionTypeByDimension(s-1)){case bt.VALUE_ROWIDS:return re.getMaxWidthValueRowID(t);case bt.ROW_SPLITS:return re.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${bt[this.getRowPartitionTypeByDimension(s-1)]}`)}}static getMaxWidthRowSplit(s){const t=s.length;if(t===0||t===1)return 0;let n=0;for(let e=0;e<t-1;++e){const a=s[e+1]-s[e];a>n&&(n=a)}return n}static getMaxWidthValueRowID(s){const t=s.length;if(t===0)return 0;let n=0,e=s[0],a=0;for(let i=1;i<t;++i){const c=s[i];c!==e&&(e=c,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}tensorShapeFromTensor(s,t,n=!0){if(t.length===0){if(s[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return qe(s,n)}calculateOutputSize(s){const t=this.valuesShape,n=this.defaultValueShape;ta(n,t);const e=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=ea(this.raggedRank,e,t);i[0]<0&&(i[0]=s);for(let c=1;c<=this.raggedRank;++c)i[c]<0&&(i[c]=this.getMaxWidth(c));return i}calculateFirstParentOutputIndex(s,t,n){const e=Math.min(s,n),a=[];let i=0;for(let c=0;c<e;++c,i+=t)a.push(i);for(let c=e;c<s;++c)a.push(-1);return ut(a.length===s,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(s,t,n,e){const a=s.length,i=[];for(let c=0;c<a-1;++c){const r=s[c+1]-s[c];let l=Math.min(e,r),d=t[c];d===-1&&(l=0);for(let u=0;u<l;++u)i.push(d),d+=n;for(let u=0;u<r-l;++u)i.push(-1)}if(a>0&&i.length!==s[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(s,t,n,e){const a=s.length,i=[];if(a===0)return[];let c=0,r=s[0];if(r>=t.length)throw new Error(`Got currentValueRowId=${r}, which is not less than ${t.length}`);let l=t[r];i.push(l);for(let d=1;d<a;++d){const u=s[d];if(u===r)l>=0&&(++c,c<e?l+=n:l=-1);else{if(c=0,r=u,u>=t.length)throw new Error(`Got nextValueRowId=${u} which is not less than ${t.length}`);l=t[u]}i.push(l)}if(i.length!==s.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(s,t,n,e){const a=this.getRowPartitionTensor(s),i=this.getRowPartitionTypeByDimension(s);switch(i){case bt.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,e);case bt.ROW_SPLITS:if(a.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(a,t,n,e);default:throw new Error(`Unsupported partition type: ${bt[i]}`)}}getFirstDimensionSize(){const s=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case bt.FIRST_DIM_SIZE:return s[0];case bt.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case bt.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${bt[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),n=this.calculateOutputSize(t),e=new Array(this.raggedRank+1);e[e.length-1]=1;for(let r=e.length-2;r>=0;--r)e[r]=e[r+1]*n[r+1];const a=qe(n,!1),i=dt(this.valuesDType,B(a));if(e[0]*n[0]>0){let r=this.calculateFirstParentOutputIndex(t,e[0],n[0]);for(let l=1;l<=this.raggedRank;++l)r=this.calculateOutputIndex(l-1,r,e[l],n[l]);this.setOutput(this.raggedRank,r,i,a)}return[a,i]}setOutput(s,t,n,e){if(n.length===0)return;const a=this.values,i=n;let c=e.slice();c=c.slice(s+1);const r=B(c),l=t.length;let d=this.defaultValue;if(d.length!==r&&d.length!==1){const m=this.defaultValueShape;na(()=>{const g=sa(d,m);d=aa(g,c).dataSync()})}let u=0,p=0,f=0;for(let m=0;m<=l;++m){let g=m<l?t[m]:-1;if(g===f){++f;continue}if(p<f){const h=a.subarray(u*r),I=i.subarray(p*r),k=(f-p)*r;Ge(I,h,k)}if(m>=l){const h=n.length;g=Math.floor(h/r)}if(g>f)if(this.defaultValue.length===1)i.subarray(f*r,g*r).fill(this.defaultValue[0]),f=g;else for(;g>f;){const h=i.slice(f*r);Ge(h,d,r),++f}g<0?(u=m+1,p=f):(u=m,p=f,f=p+1)}}}function Ge(o,s,t){for(let n=0;n<t;n++)o[n]=s[n]}function qe(o,s){const t=[];for(let n of o){if(n<0){if(!s)throw new Error(`Dimension ${n} must be >= 0`);if(n<-1)throw new Error(`Dimension ${n} must be >= -1`);n=-1}t.push(n)}return t}function Rc(o,s,t,n,e,a,i,c,r,l){return new re(o,s,t,n,e,a,i,c,r,l).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dc(o,s,t,n){const e=o===s,a=o<s&&t<0,i=s<o&&t>1;if(e||a||i)return It(0,n);const c=Math.abs(Math.ceil((s-o)/t)),r=It(c,n);s<o&&t===1&&(t=-1),r[0]=o;for(let l=1;l<r.length;l++)r[l]=r[l-1]+t;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vc=qt(o=>1/Math.sqrt(o)),Ec=jt(un,Vc),Oc={kernelName:un,backendName:"cpu",kernelFunc:Ec};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xt(o,s,t,n,e,a,i,c,r,l){const d=[n/e,e],u=o.values,p=s.values;if(n===0)return tt(t,s.dtype);const f=tt(d,s.dtype);typeof r=="string"||typeof r=="number"?f.values.fill(r):typeof r=="boolean"&&f.values.fill(+r);for(let m=0;m<a;m++){const g=[];let h=0;for(let I=0;I<i;I++){const k=u[m*i+I];g.push(k),h+=k*c[I]}if(h<0||h>=n/e)throw new Error(`Invalid indices: ${g} does not index into ${t}`);for(let I=0;I<e;I++)l?f.values[h*e+I]+=p[m*e+I]:f.values[h*e+I]=s.rank===0?p[0]:p[m*e+I]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ds=Q(pn,o=>1/(1+Math.exp(-o))),Pc={kernelName:pn,backendName:"cpu",kernelFunc:ds};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wc(o,s,t,n,e){const a=la(n,s,t),i=B(t),c=K(n);if(a){const u=da(s,c);return e==="string"?o.slice(u,u+i):o.subarray(u,u+i)}const r=e==="string"?ae(o):o,l=tt(n,e,r),d=tt(t,e);for(let u=0;u<d.size;++u){const p=d.indexToLoc(u),f=p.map((m,g)=>m+s[g]);d.set(l.get(...f),...p)}return e==="string"?ua(d.values):d.values}function Pt(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{begin:a,size:i}=n;G(e,"slice");const[c,r]=ia(e,a,i);ca(e,c,r);const l=t.data.get(e.dataId).values,d=Wc(l,c,r,e.shape,e.dtype);return t.makeTensorInfo(r,e.dtype,d)}const Ac={kernelName:ra,backendName:"cpu",kernelFunc:Pt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $c(o,s,t,n,e,a,i){const c=s[0],r=a[0],l=new Array(r),d=new Array(c),u=s[1];if(r===0){if(c!==0)throw new Error(pa(c));const h=dt(t,0),I=dt(e,0);return[h,[0,u],I,l,d]}let p=!0,f=0;const m=new Array(r).fill(0);for(let h=0;h<c;++h){const I=o[h*u];if(I<0)throw new Error(fa(h,I));if(I>=r)throw new Error(ha(h,I,r));++m[I],p=p&&I>=f,f=I}let g=!0;for(let h=0;h<r;++h){const I=m[h]===0;l[h]=I,g=g&&!I,m[h]=Math.max(m[h],1),h>0&&(m[h]+=m[h-1])}if(g&&p){const h=o,I=n;for(let k=0;k<c;++k)d[k]=k;return[h,[c,u],I,l,d]}else{const h=m[r-1],I=dt(t,h*u),k=dt(e,h),x=new Array(r).fill(0);for(let b=0;b<c;++b){const y=o[b*u],S=x[y],N=(y===0?0:m[y-1])+S;x[y]++;for(let w=0;w<u;++w)I[N*u+w]=o[b*u+w];k[N]=n[b],d[b]=N}for(let b=0;b<r;++b)if(x[b]===0){const S=b===0?0:m[b-1];I[S*u+0]=b;for(let N=1;N<u;++N)I[S*u+N]=0;k[S]=i}return[I,[h,u],k,l,d]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zc(o,s,t,n,e){const a=B(n),i=s[0],c=e.length,r=[];let l=1,d=-1;for(let h=0;h<c;++h){const I=e[h];if(I===-1){if(d!==-1)throw new Error(ma(d,h));d=h,r.push(1)}else{if(I<0)throw new Error(ga(h,I));l*=I,r.push(I)}}if(d!==-1){if(l<=0)throw new Error(Ia());const h=Math.trunc(a/l);if(l*h!==a)throw new Error(ka(n,r));r[d]=h}if(B(r)!==a)throw new Error(ba(n,r));const p=n.length,f=[];if(p>0){f[p-1]=1;for(let h=p-2;h>=0;--h)f[h]=f[h+1]*n[h+1]}const m=[];if(c>0){m[c-1]=1;for(let h=c-2;h>=0;--h)m[h]=m[h+1]*r[h+1]}const g=dt(t,i*c);for(let h=0;h<i;++h){let I=0;for(let k=0;k<p;++k)I+=o[h*p+k]*f[k];for(let k=0;k<c;++k)g[h*c+k]=Math.trunc(I/m[k]),I%=m[k]}return[g,[i,c],r]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function us(o,s,t,n,e,a=!1,i=0){const c=n.length,r=[s[0],o.length/s[0]],l=r[1],u=c>0?e[c-1]+1:0;if(u<0)throw new Error($e());const p=s.slice();p[0]=u;const f=p.reduce((x,b)=>x*b,1),m=dt(t,f);if(c===0)return u>0&&m.fill(i),[m,p];if(u<=0)throw new Error($e());let g=0,h=1,I=0,k=e[g];for(;;){let x=0;if(h<c){if(x=e[h],k===x){++h;continue}if(k>=x)throw new Error(xa())}if(k<0||k>=u)throw new Error(ya(k,u));k>I&&m.fill(i,I*l,k*l);for(let b=g;b<h;++b){const y=n[b];if(y<0||y>=r[0])throw new Error(Sa(b,n[b],r[0]));for(let S=0;S<l;S++)m[k*l+S]+=o[y*l+S]}if(a)for(let b=0;b<l;b++)m[k*l+b]/=h-g;if(g=h,++h,I=k+1,k=x,h>c)break}return I<u&&m.fill(i,I*l,u*l),[m,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hc=Q(fn,o=>Math.sqrt(o)),Lc={kernelName:fn,backendName:"cpu",kernelFunc:Hc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _c=it((o,s)=>{const t=o-s;return t*t}),Bc=ct(hn,_c),Gc={kernelName:hn,backendName:"cpu",kernelFunc:Bc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qc(o,s,t,n){const e=tt(o,s.dtype);for(let a=0;a<e.size;a++){const i=e.indexToLoc(a),c=new Array(i.length);for(let r=0;r<c.length;r++)c[r]=i[r]*t[r]+n[r];e.set(s.get(...c),...i)}return e}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jc{constructor(s,t,n,e,a,i){this.separator=ne(s),this.nGramWidths=t,this.leftPad=ne(n),this.rightPad=ne(e),this.padWidth=a,this.preserveShort=i}getPadWidth(s){return Math.min(this.padWidth<0?s-1:this.padWidth,s-1)}getNumNGrams(s,t){const n=this.getPadWidth(t);return Math.max(0,s+2*n-t+1)}createNGrams(s,t,n,e,a,i){for(let c=0;c<a;++c){const r=this.getPadWidth(i),l=Math.max(0,r-c),d=Math.max(0,r-(a-(c+1))),u=i-(l+d),p=t+(l>0?0:c-r);let f=0;f+=l*this.leftPad.length;for(let k=0;k<u;++k)f+=s[p+k].length;f+=d*this.rightPad.length;const m=l+d+u-1;f+=m*this.separator.length,n[e+c]=new Uint8Array(f);const g=n[e+c];let h=0;const I=k=>k.forEach(x=>g[h++]=x);for(let k=0;k<l;++k)I(this.leftPad),I(this.separator);for(let k=0;k<u-1;++k)I(s[p+k]),I(this.separator);if(u>0){I(s[p+u-1]);for(let k=0;k<d;++k)I(this.separator),I(this.rightPad)}else{for(let k=0;k<d-1;++k)I(this.rightPad),I(this.separator);I(this.rightPad)}}}compute(s,t){const n=s.length,e=t.length;if(e>0){let r=t[0];if(r!==0)throw new Error(`First split value must be 0, got ${r}`);for(let l=1;l<e;++l){let d=t[l]>=r;if(d=d&&t[l]<=n,!d)throw new Error(`Invalid split value ${t[l]}, must be in [${r}, ${n}]`);r=t[l]}if(r!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${r}`)}const a=e-1,i=dt("int32",e);if(n===0||e===0){const r=new Array(n);for(let l=0;l<=a;++l)i[l]=0;return[r,i]}i[0]=0;for(let r=1;r<=a;++r){const l=t[r]-t[r-1];let d=0;this.nGramWidths.forEach(u=>{d+=this.getNumNGrams(l,u)}),this.preserveShort&&l>0&&d===0&&(d=1),i[r]=i[r-1]+d}const c=new Array(i[a]);for(let r=0;r<a;++r){const l=t[r];let d=i[r];if(this.nGramWidths.forEach(u=>{const p=t[r+1]-t[r],f=this.getNumNGrams(p,u);this.createNGrams(s,l,c,d,f,u),d+=f}),this.preserveShort&&d===i[r]){const u=t[r+1]-t[r];if(u===0)continue;const p=u+2*this.padWidth,f=1;this.createNGrams(s,l,c,d,f,p)}}return[c,i]}}function Uc(o,s,t,n,e,a,i,c){return new jc(t,n,e,a,i,c).compute(o,s)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kc(o,s,t,n){if(!o.length)return;if(s.length===0){for(let a=0;a<o.length;++a)n.push(o.subarray(a,a+1));return}if(s.length===1){const a=s[0];let i=o.indexOf(a);for(;i!==-1;){const c=o.subarray(0,i);(!t||c.length!==0)&&n.push(c),o=o.subarray(i+1),i=o.indexOf(a)}(!t||o.length!==0)&&n.push(o);return}let e=0;for(let a=0;a<o.length+1;a++)if(a===o.length||s.indexOf(o[a])!==-1){const i=o.subarray(e,a);(!t||i.length!==0)&&n.push(i),e=a+1}}function Xc(o,s,t){const n=o.length,e=[];let a=0,i=0;const c=new Array(n);for(let p=0;p<n;++p){const f=e.length;Kc(o[p],s,t,e);const m=e.length-f;c[p]=m,a+=m,i=Math.max(i,m)}const r=dt("int32",a*2),l=new Array(a),d=[n,i];let u=0;for(let p=0;p<n;++p)for(let f=0;f<c[p];++f)r[u*2]=p,r[u*2+1]=f,l[u]=e[u],++u;return[r,l,d]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yc(o,s){const t=dt("int32",o.length);for(let n=0;n<o.length;++n)t[n]=Na(o[n]).modulo(s).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zc=it((o,s)=>o-s),Qc=De((o,s,t,n)=>({real:o-t,imag:s-n})),Ve=ct(mn,Zc,Qc),Jc={kernelName:mn,backendName:"cpu",kernelFunc:Ve};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tl(o,s){const t=new Array(o.rank);for(let e=0;e<t.length;e++)t[e]=o.shape[e]*s[e];const n=tt(t,o.dtype);for(let e=0;e<n.values.length;++e){const a=n.indexToLoc(e),i=new Array(o.rank);for(let r=0;r<i.length;r++)i[r]=a[r]%o.shape[r];const c=o.locToIndex(i);n.values[e]=o.values[c]}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yt=(o,s)=>{const t=s.value-o.value;return t===0?o.index-s.index:t};function ps(o,s,t=0,n=o.length-1){for(;n>t;){if(n-t>600){const c=n-t+1,r=s-t+1,l=Math.log(c),d=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*d*(c-d)/c)*Math.sign(r-c/2),p=Math.max(t,Math.floor(s-r*d/c+u)),f=Math.min(n,Math.floor(s+(c-r)*d/c+u));ps(o,s,p,f)}const e=o[s];let a=t,i=n;for(Kt(o,t,s),Yt(o[n],e)>0&&Kt(o,t,n);a<i;){for(Kt(o,a,i),a++,i--;Yt(o[a],e)<0;)a=a+1;for(;Yt(o[i],e)>0;)i=i-1}Yt(o[t],e)===0?Kt(o,t,i):(i=i+1,Kt(o,i,n)),i<=s&&(t=i+1),s<=i&&(n=i-1)}}function el(o,s,t,n,e){const a=s[s.length-1],[i,c]=[o.length/a,a],r=ft(t,i*n),l=ft("int32",i*n);for(let u=0;u<i;u++){const p=u*c,f=o.subarray(p,p+c);let m=new Array(f.length);f.forEach((k,x)=>m[x]={value:k,index:x}),n<m.length&&(ps(m,n),m=m.slice(0,n)),e&&m.sort(Yt);const g=u*n,h=r.subarray(g,g+n),I=l.subarray(g,g+n);for(let k=0;k<n;k++)h[k]=m[k].value,I[k]=m[k].index}const d=s.slice();return d[d.length-1]=n,[tt(d,t,r),tt(d,"int32",l)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nl(o,s,t,n){const e=mt(s,t)[0],a=[1,t[0],1];for(let m=0;m<e;m++)a[0]*=t[m];a[1]=t[e];for(let m=e+1;m<t.length;m++)a[2]*=t[m];const i={},c=new Int32Array(t[e]),r=new pt(a,n,o),l=[],d=a[0]===1&&a[2]===1;for(let m=0;m<t[e];m++){let g;if(d)g=o[m].toString();else{const h=[];for(let I=0;I<a[0];I++)for(let k=0;k<a[2];k++)h.push(r.get(I,m,k));g=h.join(",")}if(i[g]!==void 0)c[m]=i[g];else{const h=Object.keys(i).length;i[g]=h,c[m]=h,l.push(m)}}const u=a.slice();u[1]=Object.keys(i).length;const p=new pt(u,n);l.forEach((m,g)=>{for(let h=0;h<a[0];h++)for(let I=0;I<a[2];I++)p.set(r.get(h,m,I),h,g,I)});const f=t.slice();return f[e]=u[1],{outputValues:p.values,outputShape:f,indices:c}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */wa("cpu",()=>new he,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fs=Q(gn,o=>o>=0?o:Math.exp(o)-1),sl={kernelName:gn,backendName:"cpu",kernelFunc:fs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hs(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{alpha:a}=n;G([e],"leakyRelu");const i=B(e.shape),c=t.data.get(e.dataId).values,r=ft("float32",i);for(let l=0;l<c.length;l++)r[l]=c[l]<0?a*c[l]:c[l];return t.makeTensorInfo(e.shape,"float32",r)}const al={kernelName:va,backendName:"cpu",kernelFunc:hs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ol=it((o,s)=>o<0?s*o:o);function ms(o){const{inputs:s,backend:t}=o,{x:n,alpha:e}=s;G([n,e],"prelu");const a=t.data.get(n.dataId).values,i=t.data.get(e.dataId).values,[c,r]=ol(n.shape,e.shape,a,i,"float32");return t.makeTensorInfo(r,"float32",c)}const rl={kernelName:Ca,backendName:"cpu",kernelFunc:ms};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gs=Q(In,o=>Math.max(0,o)),il={kernelName:In,backendName:"cpu",kernelFunc:gs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Is=Q(kn,o=>Math.min(Math.max(0,o),6)),cl={kernelName:kn,backendName:"cpu",kernelFunc:Is};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ie(o,s,t,n,e){if(t==="linear")return St({inputs:{x:s},backend:o});if(t==="relu")return gs({inputs:{x:s},backend:o});if(t==="elu")return fs({inputs:{x:s},backend:o});if(t==="relu6")return Is({inputs:{x:s},backend:o});if(t==="prelu")return ms({inputs:{x:s,alpha:n},backend:o});if(t==="leakyrelu")return hs({inputs:{x:s},backend:o,attrs:{alpha:e}});if(t==="sigmoid")return ds({inputs:{x:s},backend:o});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nt(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{shape:a}=n,i=B(e.shape),c=Ma(a,i),r=B(c);ut(i===r,()=>`The new shape (${c}) has ${r} elements and the old shape (${e.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),t.incRef(e.dataId);const l=t.data.get(e.dataId);if(l.complexTensorInfos!=null){const d=l.complexTensorInfos.real,u=l.complexTensorInfos.imag;d.shape=c,u.shape=c}return{dataId:e.dataId,shape:c,dtype:e.dtype}}const ll={kernelName:Ta,backendName:"cpu",kernelFunc:nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ks(o){const{inputs:s,backend:t,attrs:n}=o,{a:e,b:a}=s,{transposeA:i,transposeB:c}=n;G([e,a],"matMul");const r=e.shape.length,l=a.shape.length,d=i?e.shape[r-2]:e.shape[r-1],u=c?a.shape[l-1]:a.shape[l-2],p=i?e.shape[r-1]:e.shape[r-2],f=c?a.shape[l-2]:a.shape[l-1],m=e.shape.slice(0,-2),g=a.shape.slice(0,-2),h=B(m),I=B(g),x=ue(e.shape.slice(0,-2),a.shape.slice(0,-2)).concat([p,f]);ut(d===u,()=>`Error in matMul: inner shapes (${d}) and (${u}) of Tensors with shapes ${e.shape} and ${a.shape} and transposeA=${i} and transposeB=${c} must match.`);const b=i?[h,d,p]:[h,p,d],y=c?[I,f,u]:[I,u,f],S=nt({inputs:{x:e},backend:t,attrs:{shape:b}}),N=nt({inputs:{x:a},backend:t,attrs:{shape:y}}),w=i?S.shape[1]:S.shape[2],F=i?S.shape[2]:S.shape[1],R=c?N.shape[1]:N.shape[2],E=Math.max(h,I),P=t.data.get(S.dataId).values,v=t.data.get(N.dataId).values,D=K(S.shape),C=K(N.shape),[T,O,M]=i?[D[0],1,D[1]]:[D[0],D[1],1],[V,A,W]=c?[1,C[1],C[0]]:[C[1],1,C[0]],H=F*R,$=tt([E,F,R],S.dtype),L=$.values,z=t.blockSize;for(let _=0;_<E;_++)for(let q=0;q<F;q+=z)for(let j=0;j<R;j+=z)for(let U=0;U<w;U+=z){const X=Math.min(q+z,F),Y=Math.min(j+z,R),Z=Math.min(U+z,w);for(let et=q;et<X;et++)for(let st=j;st<Y;st++){let at=0;for(let J=U;J<Z;J++){const ot=Math.min(_,h-1)*T,rt=Math.min(_,I-1)*W,vt=P[ot+et*O+J*M],lt=v[J*V+st*A+rt];at+=vt*lt}L[_*H+(et*R+st)]+=at}}return t.disposeIntermediateTensorInfo(S),t.disposeIntermediateTensorInfo(N),t.makeTensorInfo(x,$.dtype,$.values)}const dl={kernelName:Fa,backendName:"cpu",kernelFunc:ks};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ul(o){const{inputs:s,backend:t,attrs:n}=o,{a:e,b:a,bias:i,preluActivationWeights:c}=s,{transposeA:r,transposeB:l,activation:d,leakyreluAlpha:u}=n;let p,f,m;const g=[];p=ks({inputs:{a:e,b:a},attrs:{transposeA:r,transposeB:l},backend:t}),i&&(f=Ht({inputs:{a:p,b:i},backend:t}),g.push(p),p=f),d&&(m=ie(t,p,d,c,u),g.push(p),p=m);for(const I of g)t.disposeIntermediateTensorInfo(I);return p}const pl={kernelName:Ra,backendName:"cpu",kernelFunc:ul};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fl=Q(bn,o=>Math.acos(o)),hl={kernelName:bn,backendName:"cpu",kernelFunc:fl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ml=Q(xn,o=>Math.acosh(o)),gl={kernelName:xn,backendName:"cpu",kernelFunc:ml};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Il(o){const{inputs:s,backend:t}=o,n=s;G(s,"addN");const e=n.map(c=>t.data.get(c.dataId).values),a=tt(n[0].shape,n[0].dtype),i=a.values;for(let c=0;c<n.length;c++){const r=e[c];for(let l=0;l<i.length;l++)i[l]+=r[l]}return t.makeTensorInfo(a.shape,a.dtype,a.values)}const kl={kernelName:Da,backendName:"cpu",kernelFunc:Il};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bl(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{axis:a,keepDims:i}=n;G(e,"all");const c=mt(a,e.shape);let r=c;const l=Nt(r,e.shape.length);let d=e;l!=null&&(d=ht({inputs:{x:e},backend:t,attrs:{perm:l}}),r=wt(r.length,e.shape.length)),At("all",r,d.shape.length);const[u,p]=Tt(d.shape,r),f=B(p),m=It(B(u),d.dtype),g=t.data.get(d.dataId).values;for(let I=0;I<m.length;++I){const k=I*f;let x=g[k];for(let b=0;b<f;++b){const y=g[k+b];x=x&&y}m[I]=x}l!=null&&t.disposeIntermediateTensorInfo(d);const h=t.makeTensorInfo(u,d.dtype,m);if(i){const I=Wt(u,c),k=nt({inputs:{x:h},backend:t,attrs:{shape:I}});return t.disposeIntermediateTensorInfo(h),k}return h}const xl={kernelName:Va,backendName:"cpu",kernelFunc:bl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yl(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{axis:a,keepDims:i}=n;G(e,"any");const c=mt(a,e.shape);let r=c;const l=Nt(r,e.shape.length);let d=e;l!=null&&(d=ht({inputs:{x:e},backend:t,attrs:{perm:l}}),r=wt(r.length,e.shape.length)),At("any",r,d.shape.length);const[u,p]=Tt(d.shape,r),f=B(p),m=It(B(u),d.dtype),g=t.data.get(d.dataId).values;for(let I=0;I<m.length;++I){const k=I*f;let x=g[k];for(let b=0;b<f;++b){const y=g[k+b];x=x||y}m[I]=x}l!=null&&t.disposeIntermediateTensorInfo(d);const h=t.makeTensorInfo(u,d.dtype,m);if(i){const I=Wt(u,c),k=nt({inputs:{x:h},backend:t,attrs:{shape:I}});return t.disposeIntermediateTensorInfo(h),k}return h}const Sl={kernelName:Ea,backendName:"cpu",kernelFunc:yl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nl(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{axis:a}=n;G(e,"argMax");let i=mt(a,e.shape);const c=Nt(i,e.shape.length);let r=e;const l=[];c!=null&&(r=ht({inputs:{x:e},backend:t,attrs:{perm:c}}),l.push(r),i=wt(i.length,r.shape.length)),i=[i[0]],At("argMax",i,r.shape.length);const[d,u]=Tt(r.shape,i),p=B(d),f=It(p,"int32"),m=B(u),g=t.data.get(r.dataId).values;for(let h=0;h<f.length;++h){const I=h*m;let k=g[I],x=0;for(let b=0;b<m;++b){const y=g[I+b];y>k&&(k=y,x=b)}f[h]=x}return l.forEach(h=>t.disposeIntermediateTensorInfo(h)),t.makeTensorInfo(d,"int32",f)}const wl={kernelName:Oa,backendName:"cpu",kernelFunc:Nl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vl(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{axis:a}=n;G(e,"argMin");let i=mt(a,e.shape);const c=Nt(i,e.shape.length);let r=e;const l=[];c!=null&&(r=ht({inputs:{x:e},backend:t,attrs:{perm:c}}),l.push(r),i=wt(i.length,r.shape.length)),i=[i[0]],At("argMin",i,r.shape.length);const[d,u]=Tt(r.shape,i),p=B(d),f=It(p,"int32"),m=B(u),g=t.data.get(r.dataId).values;for(let h=0;h<f.length;++h){const I=h*m;let k=g[I],x=0;for(let b=0;b<m;++b){const y=g[I+b];y<k&&(k=y,x=b)}f[h]=x}return l.forEach(h=>t.disposeIntermediateTensorInfo(h)),t.makeTensorInfo(d,"int32",f)}const Cl={kernelName:Pa,backendName:"cpu",kernelFunc:vl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tl=Q(yn,o=>Math.asin(o)),Ml={kernelName:yn,backendName:"cpu",kernelFunc:Tl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fl=Q(Sn,o=>Math.asinh(o)),Rl={kernelName:Sn,backendName:"cpu",kernelFunc:Fl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dl=Q(Nn,o=>Math.atan(o)),Vl={kernelName:Nn,backendName:"cpu",kernelFunc:Dl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const El=it((o,s)=>Math.atan2(o,s)),Ol=ct(wn,El),Pl={kernelName:wn,backendName:"cpu",kernelFunc:Ol};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wl=Q(vn,o=>Math.atanh(o)),Al={kernelName:vn,backendName:"cpu",kernelFunc:Wl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ee(o,s,t,n,e,a){const i=e.strideHeight,c=e.strideWidth,r=e.dilationHeight,l=e.dilationWidth,d=e.effectiveFilterHeight,u=e.effectiveFilterWidth,p=e.padInfo.top,f=e.padInfo.left,m=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=tt(e.outShape,t),h=g.values,I=e.outShape[1]*e.outShape[2]*e.outShape[3],k=e.outShape[2]*e.outShape[3],x=e.outShape[3];for(let b=0;b<e.batchSize;++b){const y=b*I,S=b*n[0];for(let N=0;N<e.inChannels;++N)for(let w=0;w<e.outHeight;++w){const F=w*i-p,R=Math.max(0,F),E=Math.min(e.inHeight,d+F),P=y+w*k;for(let v=0;v<e.outWidth;++v){const D=v*c-f,C=Math.max(0,D),T=Math.min(e.inWidth,u+D);let O=m,M=0,V=0;for(let W=R;W<E;W+=r){const H=S+W*n[1];for(let $=C;$<T;$+=l){const L=H+$*n[2],z=o[L+N];a==="max"&&z>O?O=z:a==="avg"&&(M+=z,V++)}if(isNaN(O))break}const A=P+v*x+N;h[A]=a==="avg"?M/V:O}}}return g}function bs(o,s,t,n,e=!1,a=!1){const i=tt(n.outShape,"int32"),c=n.strideHeight,r=n.strideWidth,l=n.dilationHeight,d=n.dilationWidth,u=n.effectiveFilterHeight,p=n.effectiveFilterWidth,f=n.padInfo.top,m=n.padInfo.left,g=tt(s,t,o);for(let h=0;h<n.batchSize;++h)for(let I=0;I<n.inChannels;++I)for(let k=0;k<n.outHeight;++k){const x=k*c-f;let b=x;for(;b<0;)b+=l;const y=Math.min(n.inHeight,u+x);for(let S=0;S<n.outWidth;++S){const N=S*r-m;let w=N;for(;w<0;)w+=d;const F=Math.min(n.inWidth,p+N);let R=Number.NEGATIVE_INFINITY,E=-1;for(let P=b;P<y;P+=l){const v=P-x;for(let D=w;D<F;D+=d){const C=D-N,T=g.get(h,P,D,I);T>R&&(R=T,e?E=a?((h*n.inHeight+P)*n.inWidth+D)*n.inChannels+I:(P*n.inWidth+D)*n.inChannels+I:E=v*p+C)}}i.set(E,h,k,S,I)}}return i}function xs(o,s,t,n,e,a){const i=e.strideDepth,c=e.strideHeight,r=e.strideWidth,l=e.dilationDepth,d=e.dilationHeight,u=e.dilationWidth,p=e.effectiveFilterDepth,f=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=e.padInfo.front,h=e.padInfo.top,I=e.padInfo.left,k=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=tt(e.outShape,t),b=x.values,y=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],S=e.outShape[2]*e.outShape[3]*e.outShape[4],N=e.outShape[3]*e.outShape[4],w=e.outShape[4];for(let F=0;F<e.batchSize;++F){const R=F*y,E=F*n[0];for(let P=0;P<e.inChannels;++P)for(let v=0;v<e.outDepth;++v){const D=v*i-g;let C=D;for(;C<0;)C+=l;const T=Math.min(e.inDepth,p+D),O=R+v*S;for(let M=0;M<e.outHeight;++M){const V=M*c-h;let A=V;for(;A<0;)A+=d;const W=Math.min(e.inHeight,f+V),H=O+M*N;for(let $=0;$<e.outWidth;++$){const L=$*r-I;let z=L;for(;z<0;)z+=u;const _=Math.min(e.inWidth,m+L),q=H+$*w;let j=k,U=0,X=0;for(let Z=C;Z<T;Z+=l){const et=E+Z*n[1];for(let st=A;st<W;st+=d){const at=et+st*n[2];for(let J=z;J<_;J+=u){const ot=at+J*n[3],rt=o[ot+P];if(a==="max"&&rt>j?j=rt:a==="avg"&&(U+=rt,X++),isNaN(j))break}if(isNaN(j))break}if(isNaN(j))break}const Y=q+P;b[Y]=a==="avg"?U/X:j}}}}return x}function $l(o,s){const t=tt(s.outShape,"int32"),n=s.strideDepth,e=s.strideHeight,a=s.strideWidth,i=s.dilationDepth,c=s.dilationHeight,r=s.dilationWidth,l=s.effectiveFilterDepth,d=s.effectiveFilterHeight,u=s.effectiveFilterWidth,p=s.padInfo.front,f=s.padInfo.top,m=s.padInfo.left;for(let g=0;g<s.batchSize;++g)for(let h=0;h<s.inChannels;++h)for(let I=0;I<s.outDepth;++I){const k=I*n-p;let x=k;for(;x<0;)x+=i;const b=Math.min(s.inDepth,l+k);for(let y=0;y<s.outHeight;++y){const S=y*e-f;let N=S;for(;N<0;)N+=c;const w=Math.min(s.inHeight,d+S);for(let F=0;F<s.outWidth;++F){const R=F*a-m;let E=R;for(;E<0;)E+=r;const P=Math.min(s.inWidth,u+R);let v=Number.NEGATIVE_INFINITY,D=-1;for(let C=x;C<b;C+=i){const T=C-k;for(let O=N;O<w;O+=c){const M=O-S;for(let V=E;V<P;V+=r){const A=V-R,W=o.get(g,C,O,V,h);W>=v&&(v=W,D=T*d*u+M*d+A)}}}t.set(D,g,I,y,F,h)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zl(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s;G(e,"avgPool");const{filterSize:a,strides:i,pad:c,dimRoundingMode:r}=n,l=1;ut(ve(i,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);const d=Jt(e.shape,a,i,l,c,r);let u;if(d.filterWidth===1&&d.filterHeight===1&&Ce(d.inShape,d.outShape))u=St({inputs:{x:e},backend:t});else{const p=t.data.get(e.dataId).values,f=K(e.shape),m=Ee(p,e.shape,e.dtype,f,d,"avg");u=t.makeTensorInfo(d.outShape,e.dtype,m.values)}return u}const Hl={kernelName:Wa,backendName:"cpu",kernelFunc:zl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ll(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{filterSize:a,strides:i,pad:c,dimRoundingMode:r,dataFormat:l}=n;G(e,"avgPool3d");const d=fe(e.shape,a,i,1,c,r,l),u=t.data.get(e.dataId).values,p=xs(u,e.shape,e.dtype,K(e.shape),d,"avg");return t.makeTensorInfo(p.shape,"float32",p.values)}const _l={kernelName:Aa,backendName:"cpu",kernelFunc:Ll};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bl(o){const{inputs:s,backend:t,attrs:n}=o,{dy:e,input:a}=s,{filterSize:i,strides:c,pad:r,dimRoundingMode:l}=n;G([e,a],"avgPool3DGrad");const d=fe(a.shape,i,c,1,r,l),u=d.strideDepth,p=d.strideHeight,f=d.strideWidth,m=d.filterDepth,g=d.filterHeight,h=d.filterWidth,I=d.dilationDepth,k=d.dilationHeight,x=d.dilationWidth,b=d.effectiveFilterDepth,y=d.effectiveFilterHeight,S=d.effectiveFilterWidth,N=b-1-d.padInfo.front,w=S-1-d.padInfo.left,F=y-1-d.padInfo.top,R=tt(a.shape,"float32"),E=1/(m*g*h),P=t.bufferSync(e);for(let v=0;v<d.batchSize;++v)for(let D=0;D<d.inChannels;++D)for(let C=0;C<d.inDepth;++C)for(let T=0;T<d.inHeight;++T)for(let O=0;O<d.inWidth;++O){const M=C-N,V=T-F,A=O-w;let W=0;for(let H=0;H<b;H+=I){const $=(M+H)/u;if(!($<0||$>=d.outDepth||Math.floor($)!==$))for(let L=0;L<y;L+=k){const z=(V+L)/p;if(!(z<0||z>=d.outHeight||Math.floor(z)!==z))for(let _=0;_<S;_+=x){const q=(A+_)/f;if(q<0||q>=d.outWidth||Math.floor(q)!==q)continue;const j=P.get(v,$,z,q,D);W+=j}}}R.set(W*E,v,C,T,O,D)}return t.makeTensorInfo(R.shape,R.dtype,R.values)}const Gl={kernelName:$a,backendName:"cpu",kernelFunc:Bl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ql(o){const{inputs:s,backend:t,attrs:n}=o,{dy:e,input:a}=s,i=a;G([e,a],"avgPoolGrad");const{filterSize:c,strides:r,pad:l}=n,d=Jt(i.shape,c,r,1,l),u=d.strideHeight,p=d.strideWidth,f=d.filterHeight,m=d.filterWidth,g=d.dilationHeight,h=d.dilationWidth,I=d.effectiveFilterHeight,k=d.effectiveFilterWidth,x=k-1-d.padInfo.left,b=I-1-d.padInfo.top,y=tt(i.shape,"float32"),S=1/(f*m),N=t.data.get(e.dataId).values,w=tt(e.shape,"float32",N);for(let F=0;F<d.batchSize;++F)for(let R=0;R<d.inChannels;++R)for(let E=0;E<d.inHeight;++E)for(let P=0;P<d.inWidth;++P){const v=E-b,D=P-x;let C=0;for(let T=0;T<I;T+=g){const O=(v+T)/u;if(!(O<0||O>=d.outHeight||Math.floor(O)!==O))for(let M=0;M<k;M+=h){const V=(D+M)/p;if(V<0||V>=d.outWidth||Math.floor(V)!==V)continue;const A=w.get(F,O,V,R);C+=A}}y.set(C*S,F,E,P,R)}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const jl={kernelName:za,backendName:"cpu",kernelFunc:ql};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ul(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,scale:a,offset:i,mean:c,variance:r}=s;ut(c.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ut(i==null||c.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ut(a==null||c.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),G([e,c,r,a,i],"batchNorm");let{varianceEpsilon:l}=n;l==null&&(l=.001);const d=t.data.get(e.dataId).values,u=t.data.get(c.dataId).values,p=t.data.get(r.dataId).values,f=a?t.data.get(a.dataId).values:new Float32Array([1]),m=i?t.data.get(i.dataId).values:new Float32Array([0]),g=new Float32Array(d.length),h=m.length,I=f.length,k=p.length,x=u.length;let b=0,y=0,S=0,N=0;for(let w=0;w<d.length;++w)g[w]=m[b++]+(d[w]-u[y++])*f[S++]/Math.sqrt(p[N++]+l),b>=h&&(b=0),y>=x&&(y=0),S>=I&&(S=0),N>=k&&(N=0);return t.makeTensorInfo(e.shape,e.dtype,g)}const Kl={kernelName:Ha,backendName:"cpu",kernelFunc:Ul};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xl(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{blockShape:a,crops:i}=n;G([e],"batchToSpaceND");const c=a.reduce((I,k)=>I*k),r=Cn(e.shape,a,c),l=Tn(r.length,a.length),d=Mn(e.shape,a,c),u=_a(i,a.length),p=Ba(d,i,a.length),f=nt({inputs:{x:e},backend:t,attrs:{shape:r}}),m=ht({inputs:{x:f},backend:t,attrs:{perm:l}}),g=nt({inputs:{x:m},backend:t,attrs:{shape:d}}),h=Pt({inputs:{x:g},backend:t,attrs:{begin:u,size:p}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),h}const Yl={kernelName:La,backendName:"cpu",kernelFunc:Xl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zl(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,weights:a}=s,{size:i}=n,c=t.data.get(e.dataId).values,r=t.data.get(a.dataId).values,l=os(c,r,a.dtype,a.shape,i);return t.makeTensorInfo([i],a.dtype,l)}const Ql={kernelName:Ga,backendName:"cpu",kernelFunc:Zl};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jl(o){const{inputs:s,backend:t}=o,{s0:n,s1:e}=s,a=t.data.get(n.dataId).values,i=t.data.get(e.dataId).values,c=ue(Array.from(a),Array.from(i));return t.makeTensorInfo([c.length],"int32",Int32Array.from(c))}const td={kernelName:qa,backendName:"cpu",kernelFunc:Jl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ed=Q(Fn,(o,s)=>{const t=s;return o>t.clipValueMax?t.clipValueMax:o<t.clipValueMin?t.clipValueMin:o}),nd={kernelName:Fn,backendName:"cpu",kernelFunc:ed};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sd=o=>{const{x:s}=o.inputs,t=o.backend,n=new Float32Array(B(s.shape)),e=t.data.get(s.dataId),a=e.complexTensorInfos.real,i=e.complexTensorInfos.imag,c=t.data.get(a.dataId).values,r=t.data.get(i.dataId).values;for(let l=0;l<c.length;l++){const d=c[l],u=r[l];n[l]=Math.hypot(d,u)}return t.makeOutput(n,s.shape,"float32")},ad={kernelName:ja,backendName:"cpu",kernelFunc:sd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lt(o){const{inputs:s,backend:t}=o,{input:n}=s,e=t.data.get(n.dataId).complexTensorInfos.imag,a=t.data.get(e.dataId).values;return t.makeTensorInfo(e.shape,e.dtype,a)}const od={kernelName:Ua,backendName:"cpu",kernelFunc:Lt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _t(o){const{inputs:s,backend:t,attrs:n}=o,{axis:e}=n,a=mt(e,s[0].shape)[0],i=s.map(g=>g.shape);Xa(i,a);let c=ke(s.map(g=>g.shape),a);if(B(c)===0)return t.makeTensorInfo(c,s[0].dtype,[]);const r=s.filter(g=>B(g.shape)>0);if(r.length===1)return St({inputs:{x:r[0]},backend:t});if(r[0].dtype==="complex64"){const g=r.map(b=>Ot({inputs:{input:b},backend:t})),h=r.map(b=>Lt({inputs:{input:b},backend:t})),I=_t({inputs:g,backend:t,attrs:{axis:a}}),k=_t({inputs:h,backend:t,attrs:{axis:a}}),x=gt({inputs:{real:I,imag:k},backend:t});return g.forEach(b=>t.disposeIntermediateTensorInfo(b)),h.forEach(b=>t.disposeIntermediateTensorInfo(b)),t.disposeIntermediateTensorInfo(I),t.disposeIntermediateTensorInfo(k),x}const l=r.map(g=>{const I=[-1,B(g.shape.slice(a))];return nt({inputs:{x:g},backend:t,attrs:{shape:I}})}),d=l.map(g=>({vals:t.data.get(g.dataId).values,shape:g.shape}));c=ke(l.map(g=>g.shape),1);const u=l[0].shape[0]===1,p=Fi(d,c,s[0].dtype,u),f=ke(r.map(g=>g.shape),a),m=t.makeTensorInfo(f,s[0].dtype,p);return l.forEach(g=>t.disposeIntermediateTensorInfo(g)),m}const rd={kernelName:Ka,backendName:"cpu",kernelFunc:_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ys(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,filter:a}=s,{strides:i,pad:c,dataFormat:r,dilations:l,dimRoundingMode:d}=n;G([e,a],"conv2d");const u=Te(r),p=Gt(e.shape,a.shape,i,l,c,d,!1,u),f=p.filterHeight,m=p.filterWidth,g=p.dilationHeight,h=p.dilationWidth,I=p.padInfo.left,k=p.padInfo.top,x=p.dataFormat==="channelsLast",b=new pt(p.outShape,e.dtype),y=K(e.shape),S=K(a.shape),N=y[0],w=x?y[1]:y[2],F=x?y[2]:1,R=x?1:y[1],E=b.strides[0],P=x?b.strides[1]:b.strides[2],v=x?b.strides[2]:1,D=x?1:b.strides[1],C=t.data.get(e.dataId).values,T=t.data.get(a.dataId).values,O=b.values;for(let M=0;M<p.batchSize;++M){const V=M*N,A=M*E;for(let W=0;W<p.outHeight;++W){const H=A+W*P,$=W*p.strideHeight-k;for(let L=0;L<f;++L){const z=$+L*g;if(z<0||z>=p.inHeight)continue;const _=L*S[0],q=V+z*w;for(let j=0;j<p.outWidth;++j){const U=H+j*v,X=j*p.strideWidth-I;for(let Y=0;Y<m;++Y){const Z=X+Y*h;if(Z<0||Z>=p.inWidth)continue;const et=_+Y*S[1],st=q+Z*F;let at=et;for(let J=0;J<p.inChannels;++J){const ot=C[st+J*R];for(let rt=0;rt<p.outChannels;++rt)O[U+rt*D]+=ot*T[at+rt];at+=p.outChannels}}}}}}return t.makeTensorInfo(b.shape,b.dtype,O)}const id={kernelName:Ya,backendName:"cpu",kernelFunc:ys};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cd(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,dy:a}=s,{strides:i,pad:c,dataFormat:r,dimRoundingMode:l,filterShape:d}=n;G([e,a],"conv2dBackpropFilter");const u=Te(r),p=Gt(e.shape,d,i,1,c,l,!1,u),{strideHeight:f,strideWidth:m,filterHeight:g,filterWidth:h}=p,I=p.dataFormat==="channelsLast",k=new pt(p.filterShape,"float32"),x=p.padInfo.left,b=p.padInfo.top,y=t.data.get(e.dataId).values,S=t.data.get(a.dataId).values,N=new pt(e.shape,e.dtype,y),w=new pt(a.shape,a.dtype,S);for(let F=0;F<g;++F){const R=Math.max(0,Math.ceil((b-F)/f)),E=Math.min(p.outHeight,(p.inHeight+b-F)/f);for(let P=0;P<h;++P){const v=Math.max(0,Math.ceil((x-P)/m)),D=Math.min(p.outWidth,(p.inWidth+x-P)/m);for(let C=0;C<p.inChannels;++C)for(let T=0;T<p.outChannels;++T){let O=0;for(let M=0;M<p.batchSize;++M)for(let V=R;V<E;++V){const A=F+V*f-b;for(let W=v;W<D;++W){const H=P+W*m-x;I?O+=N.get(M,A,H,C)*w.get(M,V,W,T):O+=N.get(M,C,A,H)*w.get(M,T,V,W)}}k.set(O,F,P,C,T)}}}return t.makeTensorInfo(k.shape,k.dtype,k.values)}const ld={kernelName:Za,backendName:"cpu",kernelFunc:cd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dd(o){const{inputs:s,backend:t,attrs:n}=o,{dy:e,filter:a}=s,{inputShape:i,strides:c,pad:r,dataFormat:l,dimRoundingMode:d}=n;G([e,a],"conv2dBackpropInput");const u=K(a.shape),p=K(e.shape);let f=Te(l);const m=Gt(i,a.shape,c,1,r,d,!1,f),g=new pt(m.inShape,"float32"),h=g.values,I=t.data.get(e.dataId).values,k=t.data.get(a.dataId).values,[x,b,y]=u,{batchSize:S,filterHeight:N,filterWidth:w,inChannels:F,inHeight:R,inWidth:E,outChannels:P,outHeight:v,outWidth:D,strideHeight:C,strideWidth:T}=m;f=m.dataFormat;const O=N-1-m.padInfo.top,M=w-1-m.padInfo.left,V=f==="channelsLast",A=g.strides[0],W=V?g.strides[1]:g.strides[2],H=V?g.strides[2]:1,$=V?1:g.strides[1],L=p[0],z=V?p[1]:p[2],_=V?p[2]:1,q=V?1:p[1];for(let j=0;j<S;++j)for(let U=0;U<F;++U)for(let X=0;X<R;++X){const Y=X-O,Z=Math.max(0,Math.ceil(Y/C)),et=Math.min(v,(N+Y)/C);for(let st=0;st<E;++st){const at=st-M,J=Math.max(0,Math.ceil(at/T)),ot=Math.min(D,(w+at)/T);let rt=0;for(let lt=Z;lt<et;++lt){const Mt=lt*C-Y;for(let kt=J;kt<ot;++kt){const Et=kt*T-at,xt=L*j+z*lt+_*kt,Ct=x*(N-1-Mt)+b*(w-1-Et)+y*U;for(let Ft=0;Ft<P;++Ft){const Rt=I[xt+q*Ft],Dt=k[Ct+Ft];rt+=Rt*Dt}}}const vt=A*j+W*X+H*st+$*U;h[vt]=rt}}return t.makeTensorInfo(g.shape,g.dtype,g.values)}const ud={kernelName:Qa,backendName:"cpu",kernelFunc:dd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pd(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,filter:a}=s,{strides:i,pad:c,dilations:r}=n;G([e,a],"conv3d");const l=Me(e.shape,a.shape,i,r,c),{filterDepth:d,filterHeight:u,filterWidth:p,dilationDepth:f,dilationHeight:m,dilationWidth:g,padInfo:h}=l,I=h.front,k=h.left,x=h.top,b=new pt(l.outShape,e.dtype),y=t.data.get(e.dataId).values,S=t.data.get(a.dataId).values,N=b.values,w=K(e.shape),F=K(a.shape);for(let R=0;R<l.batchSize;++R){const E=R*w[0],P=R*b.strides[0];for(let v=0;v<l.outDepth;++v){const D=P+v*b.strides[1],C=v*l.strideDepth-I;for(let T=0;T<d;++T){const O=C+T*f;if(O<0||O>=l.inDepth)continue;const M=T*F[0],V=E+O*w[1];for(let A=0;A<l.outHeight;++A){const W=D+A*b.strides[2],H=A*l.strideHeight-x;for(let $=0;$<u;++$){const L=H+$*m;if(L<0||L>=l.inHeight)continue;const z=M+$*F[1],_=V+L*w[2];for(let q=0;q<l.outWidth;++q){const j=W+q*l.outChannels,U=q*l.strideWidth-k;for(let X=0;X<p;++X){const Y=U+X*g;if(Y<0||Y>=l.inWidth)continue;const Z=z+X*F[2],et=_+Y*l.inChannels;let st=Z;for(let at=0;at<l.inChannels;++at){const J=y[et+at];for(let ot=0;ot<l.outChannels;++ot)N[j+ot]+=J*S[st+ot];st+=l.outChannels}}}}}}}}return t.makeTensorInfo(b.shape,b.dtype,b.values)}const fd={kernelName:Ja,backendName:"cpu",kernelFunc:pd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hd(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,dy:a}=s,{strides:i,pad:c,filterShape:r}=n;G([e,a],"conv3dBackpropFilterV2");const l=K(e.shape),d=K(a.shape),u=Me(e.shape,r,i,1,c),p=u.strideDepth,f=u.strideHeight,m=u.strideWidth,g=u.filterDepth,h=u.filterHeight,I=u.filterWidth,k=new pt(u.filterShape,"float32"),x=k.values,[b,y,S,N]=k.strides,w=t.data.get(a.dataId).values,[F,R,E,P]=d,v=t.data.get(e.dataId).values,[D,C,T,O]=l,M=u.padInfo.front,V=u.padInfo.left,A=u.padInfo.top;for(let W=0;W<g;++W){const H=Math.max(0,Math.ceil((M-W)/p)),$=Math.min(u.outDepth,(u.inDepth+M-W)/p),L=W*b;for(let z=0;z<h;++z){const _=Math.max(0,Math.ceil((A-z)/f)),q=Math.min(u.outHeight,(u.inHeight+A-z)/f),j=z*y+L;for(let U=0;U<I;++U){const X=Math.max(0,Math.ceil((V-U)/m)),Y=Math.min(u.outWidth,(u.inWidth+V-U)/m),Z=U*S+j;for(let et=0;et<u.inChannels;++et){const st=et*N+Z;for(let at=0;at<u.outChannels;++at){let J=0;for(let ot=0;ot<u.batchSize;++ot){const rt=ot*D,vt=ot*F;for(let lt=H;lt<$;++lt){const kt=(W+lt*p-M)*C+rt,Et=lt*R+vt;for(let xt=_;xt<q;++xt){const Ft=(z+xt*f-A)*T+kt,Rt=xt*E+Et;for(let Dt=X;Dt<Y;++Dt){const ge=(U+Dt*m-V)*O+Ft,Ie=Dt*P+Rt;J+=v[ge+et]*w[Ie+at]}}}}x[st+at]=J}}}}}return t.makeTensorInfo(k.shape,k.dtype,k.values)}const md={kernelName:to,backendName:"cpu",kernelFunc:hd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gd(o){const{inputs:s,backend:t,attrs:n}=o,{dy:e,filter:a}=s,{pad:i,strides:c,inputShape:r}=n;G([e],"conv3dBackpropInputV2");const l=K(e.shape),d=K(a.shape),u=Me(r,a.shape,c,1,i),p=new pt(u.inShape,"float32"),f=p.values,[m,g,h,I]=p.strides,k=t.data.get(e.dataId).values,[x,b,y,S]=l,N=t.data.get(a.dataId).values,[w,F,R,E]=d,{batchSize:P,filterDepth:v,filterHeight:D,filterWidth:C,inChannels:T,inDepth:O,inHeight:M,inWidth:V,outChannels:A,outDepth:W,outHeight:H,outWidth:$,strideDepth:L,strideHeight:z,strideWidth:_}=u,q=v-1-u.padInfo.front,j=D-1-u.padInfo.top,U=C-1-u.padInfo.left;for(let X=0;X<P;++X)for(let Y=0;Y<T;++Y)for(let Z=0;Z<O;++Z){const et=Z-q,st=Math.max(0,Math.ceil(et/L)),at=Math.min(W,(v+et)/L);for(let J=0;J<M;++J){const ot=J-j,rt=Math.max(0,Math.ceil(ot/z)),vt=Math.min(H,(D+ot)/z);for(let lt=0;lt<V;++lt){const Mt=lt-U,kt=Math.max(0,Math.ceil(Mt/_)),Et=Math.min($,(C+Mt)/_);let xt=0;for(let Ct=st;Ct<at;++Ct){const Ft=Ct*L-et;for(let Rt=rt;Rt<vt;++Rt){const Dt=Rt*z-ot;for(let Ut=kt;Ut<Et;++Ut){const ge=Ut*_-Mt,Ie=x*X+b*Ct+y*Rt+S*Ut,Fs=w*(v-1-Ft)+F*(D-1-Dt)+R*(C-1-ge)+E*Y;for(let ee=0;ee<A;++ee){const Rs=k[Ie+ee],Ds=N[Fs+ee];xt+=Rs*Ds}}}}f[m*X+g*Z+h*J+I*lt+Y]=xt}}}return t.makeTensorInfo(p.shape,p.dtype,p.values)}const Id={kernelName:eo,backendName:"cpu",kernelFunc:gd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kd=Q(Rn,o=>Math.cos(o)),bd={kernelName:Rn,backendName:"cpu",kernelFunc:kd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xd=Q(Dn,o=>Math.cosh(o)),yd={kernelName:Dn,backendName:"cpu",kernelFunc:xd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sd(o){const{inputs:s,backend:t,attrs:n}=o,{image:e,boxes:a,boxInd:i}=s,{cropSize:c,method:r,extrapolationValue:l}=n,[d,u,p,f]=e.shape,m=a.shape[0],[g,h]=c,I=tt([m,g,h,f],"float32"),k=t.data.get(a.dataId).values,x=t.data.get(i.dataId).values,b=t.data.get(e.dataId).values,y=K(e.shape),S=K(I.shape);for(let N=0;N<m;N++){const w=N*4,F=k[w],R=k[w+1],E=k[w+2],P=k[w+3],v=x[N];if(v>=d)continue;const D=g>1?(E-F)*(u-1)/(g-1):0,C=h>1?(P-R)*(p-1)/(h-1):0;for(let T=0;T<g;T++){const O=g>1?F*(u-1)+T*D:.5*(F+E)*(u-1);if(O<0||O>u-1){for(let M=0;M<h;M++)for(let V=0;V<f;V++){const A=V+M*S[2]+T*S[1]+N*S[0];I.values[A]=l}continue}if(r==="bilinear"){const M=Math.floor(O),V=Math.ceil(O),A=O-M;for(let W=0;W<h;W++){const H=h>1?R*(p-1)+W*C:.5*(R+P)*(p-1);if(H<0||H>p-1){for(let _=0;_<f;_++){const q=_+W*S[2]+T*S[1]+N*S[0];I.values[q]=l}continue}const $=Math.floor(H),L=Math.ceil(H),z=H-$;for(let _=0;_<f;_++){let q=_+$*y[2]+M*y[1]+v*y[0];const j=b[q];q=_+L*y[2]+M*y[1]+v*y[0];const U=b[q];q=_+$*y[2]+V*y[1]+v*y[0];const X=b[q];q=_+L*y[2]+V*y[1]+v*y[0];const Y=b[q],Z=j+(U-j)*z,et=X+(Y-X)*z;q=_+W*S[2]+T*S[1]+N*S[0],I.values[q]=Z+(et-Z)*A}}}else for(let M=0;M<h;++M){const V=h>1?R*(p-1)+M*C:.5*(R+P)*(p-1);if(V<0||V>p-1){for(let H=0;H<f;H++){const $=H+M*S[2]+T*S[1]+N*S[0];I.values[$]=l}continue}const A=Math.round(V),W=Math.round(O);for(let H=0;H<f;H++){const $=H+A*y[2]+W*y[1]+v*y[0],L=H+M*S[2]+T*S[1]+N*S[0];I.values[L]=b[$]}}}}return t.makeTensorInfo(I.shape,I.dtype,I.values)}const Nd={kernelName:no,backendName:"cpu",kernelFunc:Sd};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wd(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{axis:a,exclusive:i,reverse:c}=n;G(e,"cumprod");const r=Nt([a],e.shape.length);let l=e;r!=null&&(l=ht({inputs:{x:e},backend:t,attrs:{perm:r}}));const d=wt(1,e.shape.length)[0];if(d!==l.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${d}`);const u=Qt(l.dtype,"int32"),p=ao(B(l.shape),u),f=t.data.get(l.dataId).values,m=l.shape[l.shape.length-1],g=c?(I,k)=>I+m-k-1:(I,k)=>I+k;for(let I=0;I<f.length;I+=m)for(let k=0;k<m;k++){const x=g(I,k);if(k===0)p[x]=i?1:f[x];else{const b=g(I,k-1);p[x]=i?f[b]*p[b]:f[x]*p[b]}}const h=t.makeTensorInfo(l.shape,u,p);if(r!=null){const I=Vn(r),k=ht({inputs:{x:h},backend:t,attrs:{perm:I}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(l),k}return h}const vd={kernelName:so,backendName:"cpu",kernelFunc:wd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cd(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{axis:a,exclusive:i,reverse:c}=n;G(e,"cumsum");const r=Nt([a],e.shape.length);let l=e;r!=null&&(l=ht({inputs:{x:e},backend:t,attrs:{perm:r}}));const d=wt(1,e.shape.length)[0];if(d!==l.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${d}`);const u=Qt(l.dtype,"int32"),p=It(B(l.shape),u),f=t.data.get(l.dataId).values,m=l.shape[l.shape.length-1],g=c?(I,k)=>I+m-k-1:(I,k)=>I+k;for(let I=0;I<f.length;I+=m)for(let k=0;k<m;k++){const x=g(I,k);if(k===0)p[x]=i?0:f[x];else{const b=g(I,k-1);p[x]=i?f[b]+p[b]:f[x]+p[b]}}const h=t.makeTensorInfo(l.shape,u,p);if(r!=null){const I=Vn(r),k=ht({inputs:{x:h},backend:t,attrs:{perm:I}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(l),k}return h}const Td={kernelName:oo,backendName:"cpu",kernelFunc:Cd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Md(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,weights:a}=s,{size:i,binaryOutput:c}=n;if(e.shape.length===1){const r=t.data.get(e.dataId).values,l=t.data.get(a.dataId).values,d=os(r,l,a.dtype,a.shape,i);return t.makeTensorInfo([i],a.dtype,d)}else if(e.shape.length===2){const r=t.bufferSync(e),l=t.bufferSync(a),d=vi(r,l,i,c);return t.makeTensorInfo(d.shape,a.dtype,d.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${e.shape.length}.`)}const Fd={kernelName:ro,backendName:"cpu",kernelFunc:Md};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rd(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{blockSize:a,dataFormat:i}=n;ut(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const c=e.shape[0],r=e.shape[1],l=e.shape[2],d=e.shape[3],u=r*a,p=l*a,f=d/(a*a),m=t.data.get(e.dataId).values,g=new Float32Array(c*u*p*f);let h=0;for(let I=0;I<c;++I)for(let k=0;k<u;++k){const x=Math.floor(k/a),b=k%a;for(let y=0;y<p;++y){const S=Math.floor(y/a),N=y%a,w=(b*a+N)*f;for(let F=0;F<f;++F){const E=F+w+d*(S+l*(x+r*I));g[h++]=m[E]}}}return t.makeTensorInfo([c,u,p,f],e.dtype,g)}const Dd={kernelName:io,backendName:"cpu",kernelFunc:Rd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ss(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,filter:a}=s,{strides:i,pad:c,dilations:r,dimRoundingMode:l}=n;G([e,a],"depthwiseConv2DNative");const d=K(e.shape),u=K(a.shape);let p=r;p==null&&(p=[1,1]),ut(ve(i,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${p}'`);const f=Gt(e.shape,a.shape,i,p,c,l,!0),{filterHeight:m,filterWidth:g,dilationHeight:h,dilationWidth:I,padInfo:k}=f,x=k.left,b=k.top,y=f.outChannels/f.inChannels,S=new pt(f.outShape,e.dtype),N=t.data.get(e.dataId).values,w=t.data.get(a.dataId).values,F=S.values;for(let R=0;R<f.batchSize;++R){const E=R*d[0],P=R*S.strides[0];for(let v=0;v<f.outHeight;++v){const D=P+v*S.strides[1],C=v*f.strideHeight-b;for(let T=0;T<m;++T){const O=C+T*h;if(O<0||O>=f.inHeight)continue;const M=T*u[0],V=E+O*d[1];for(let A=0;A<f.outWidth;++A){const W=D+A*S.strides[2],H=A*f.strideWidth-x;for(let $=0;$<g;++$){const L=H+$*I;if(L<0||L>=f.inWidth)continue;const z=M+$*u[1],_=V+L*f.inChannels;let q=W,j=z;for(let U=0;U<f.inChannels;++U){const X=N[_+U];for(let Y=0;Y<y;++Y)F[q+Y]+=X*w[j+Y];q+=y,j+=y}}}}}}return t.makeTensorInfo(S.shape,S.dtype,S.values)}const Vd={kernelName:co,backendName:"cpu",kernelFunc:Ss};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ed(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,dy:a}=s,{strides:i,dilations:c,pad:r,dimRoundingMode:l,filterShape:d}=n;G([e,a],"depthwiseConv2dNativeBackpropFilter");const u=Gt(e.shape,d,i,c,r,l,!0),{strideHeight:p,strideWidth:f,filterHeight:m,filterWidth:g}=u,h=new pt(u.filterShape,"float32"),I=u.padInfo.left,k=u.padInfo.top,x=u.outChannels/u.inChannels,b=t.data.get(e.dataId).values,y=new pt(e.shape,e.dtype,b),S=t.data.get(a.dataId).values,N=new pt(a.shape,a.dtype,S);for(let w=0;w<m;++w){const F=Math.max(0,Math.ceil((k-w)/p)),R=Math.min(u.outHeight,(u.inHeight+k-w)/p);for(let E=0;E<g;++E){const P=Math.max(0,Math.ceil((I-E)/f)),v=Math.min(u.outWidth,(u.inWidth+I-E)/f);for(let D=0;D<u.outChannels;++D){const C=Math.trunc(D/x),T=D%x;let O=0;for(let M=0;M<u.batchSize;++M)for(let V=F;V<R;++V){const A=w+V*p-k;for(let W=P;W<v;++W){const H=E+W*f-I;O+=y.get(M,A,H,C)*N.get(M,V,W,D)}}h.set(O,w,E,C,T)}}}return t.makeTensorInfo(h.shape,h.dtype,h.values)}const Od={kernelName:lo,backendName:"cpu",kernelFunc:Ed};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pd(o){const{inputs:s,backend:t,attrs:n}=o,{dy:e,filter:a}=s,{strides:i,dilations:c,pad:r,dimRoundingMode:l,inputShape:d}=n;G([e,a],"depthwiseConv2DNativeBackpropInput");const u=K(e.shape),p=K(a.shape),f=Gt(d,a.shape,i,c,r,l,!0),m=new pt(f.inShape,"float32"),g=m.values,[h,I,k]=m.strides,x=t.data.get(e.dataId).values,[b,y,S]=u,N=t.data.get(a.dataId).values,[w,F,R]=p,{batchSize:E,filterHeight:P,filterWidth:v,inChannels:D,inHeight:C,inWidth:T,outChannels:O,outHeight:M,outWidth:V,strideHeight:A,strideWidth:W}=f,H=P-1-f.padInfo.top,$=v-1-f.padInfo.left,L=O/D;for(let z=0;z<E;++z)for(let _=0;_<D;++_)for(let q=0;q<C;++q){const j=q-H,U=Math.max(0,Math.ceil(j/A)),X=Math.min(M,(P+j)/A);for(let Y=0;Y<T;++Y){const Z=Y-$,et=Math.max(0,Math.ceil(Z/W)),st=Math.min(V,(v+Z)/W);let at=0;for(let J=U;J<X;++J){const ot=J*A-j;for(let rt=et;rt<st;++rt){const vt=rt*W-Z,lt=b*z+y*J+S*rt,Mt=w*(P-1-ot)+F*(v-1-vt)+R*_;for(let kt=0;kt<L;++kt){const Et=_*L+kt,xt=x[lt+Et],Ct=N[Mt+kt];at+=xt*Ct}}}g[h*z+I*q+k*Y+_]=at}}return t.makeTensorInfo(m.shape,m.dtype,m.values)}const Wd={kernelName:uo,backendName:"cpu",kernelFunc:Pd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ad(o){const{inputs:s,backend:t}=o,{x:n}=s,e=B(n.shape),a=t.data.get(n.dataId).values,i=tt([e,e],n.dtype),c=i.values;for(let l=0;l<a.length;l++)c[l*e+l]=a[l];const r=[...n.shape,...n.shape];return t.makeTensorInfo(r,i.dtype,i.values)}const $d={kernelName:po,backendName:"cpu",kernelFunc:Ad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zd={kernelName:fo,backendName:"cpu",kernelFunc:({inputs:o,backend:s,attrs:t})=>{const{x:n,filter:e}=o,{strides:a,pad:i,dilations:c}=t,r=s,l=r.data.get(n.dataId).values,d=n.shape.length,u=r.data.get(e.dataId).values,p=e.shape.length,{batchSize:f,inHeight:m,inWidth:g,inChannels:h,outHeight:I,outWidth:k,padInfo:x,strideHeight:b,strideWidth:y,filterHeight:S,filterWidth:N,dilationHeight:w,dilationWidth:F,outShape:R}=Fe(n.shape,e.shape,a,i,"NHWC",c),E=B(R),P=R.length,v=dt(n.dtype,E);for(let C=0;C<f;++C)for(let T=0;T<I;++T){const O=T*b-x.top;for(let M=0;M<k;++M){const V=M*y-x.left;for(let A=0;A<h;++A){let W=Number.MIN_SAFE_INTEGER;for(let $=0;$<S;++$){const L=O+$*w;if(L>=0&&L<m)for(let z=0;z<N;++z){const _=V+z*F;if(_>=0&&_<g){const q=yt([C,L,_,A],d,K(n.shape)),j=yt([$,z,A],p,K(e.shape)),U=l[q]+u[j];U>W&&(W=U)}}}const H=yt([C,T,M,A],P,K(R));v[H]=W}}}return{dataId:r.write(pe(v,n.dtype),R,n.dtype),shape:R,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hd={kernelName:ze,backendName:"cpu",kernelFunc:({inputs:o,backend:s,attrs:t})=>{const{x:n,filter:e,dy:a}=o,{strides:i,pad:c,dilations:r}=t,l=s,d=$t(n.shape,l.data.get(n.dataId).values),u=$t(e.shape,l.data.get(e.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:h,outWidth:I,padInfo:k,strideHeight:x,strideWidth:b,filterHeight:y,filterWidth:S,dilationHeight:N,dilationWidth:w,outShape:F}=Fe(n.shape,e.shape,i,c,"NHWC",r);ut(a.rank===F.length,()=>`Error in ${ze}, dy must have the same rank as output ${F.length}, but got ${a.rank}`);const R=$t(F,l.data.get(a.dataId).values),E=En(e.shape,e.dtype);for(let v=0;v<p;++v)for(let D=0;D<h;++D){const C=D*x-k.top;for(let T=0;T<I;++T){const O=T*b-k.left;for(let M=0;M<g;++M){let V=Number.MIN_SAFE_INTEGER,A=0,W=0;for(let H=0;H<y;++H){const $=C+H*N;if($>=0&&$<f)for(let L=0;L<S;++L){const z=O+L*w;if(z>=0&&z<m){const _=d[v][$][z][M]+u[H][L][M];_>V&&(V=_,A=H,W=L)}}}E[A][W][M]+=R[v][D][T][M]}}}return{dataId:l.write(pe(E,n.dtype),e.shape,e.dtype),shape:e.shape,dtype:e.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ld={kernelName:He,backendName:"cpu",kernelFunc:({inputs:o,backend:s,attrs:t})=>{const{x:n,filter:e,dy:a}=o,{strides:i,pad:c,dilations:r}=t,l=s,d=$t(n.shape,l.data.get(n.dataId).values),u=$t(e.shape,l.data.get(e.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:h,outWidth:I,padInfo:k,strideHeight:x,strideWidth:b,filterHeight:y,filterWidth:S,dilationHeight:N,dilationWidth:w,outShape:F}=Fe(n.shape,e.shape,i,c,"NHWC",r);ut(a.rank===F.length,()=>`Error in ${He}, dy must have the same rank as output ${F.length}, but got ${a.rank}`);const R=$t(F,l.data.get(a.dataId).values),E=En(n.shape,n.dtype);for(let v=0;v<p;++v)for(let D=0;D<h;++D){const C=D*x-k.top;for(let T=0;T<I;++T){const O=T*b-k.left;for(let M=0;M<g;++M){let V=Number.MIN_SAFE_INTEGER,A=C<0?0:C,W=O<0?0:O;for(let H=0;H<y;++H){const $=C+H*N;if($>=0&&$<f)for(let L=0;L<S;++L){const z=O+L*w;if(z>=0&&z<m){const _=d[v][$][z][M]+u[H][L][M];_>V&&(V=_,A=$,W=z)}}}E[v][A][W][M]+=R[v][D][T][M]}}}return{dataId:l.write(pe(E,n.dtype),n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function te(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{axis:a,keepDims:i}=n;G(e,"sum");let c;e.dtype==="bool"?c=Vt({inputs:{x:e},backend:t,attrs:{dtype:"int32"}}):c=St({inputs:{x:e},backend:t});const r=c.shape.length,l=mt(a,c.shape),d=Nt(l,r);let u=l,p=c;d!=null&&(p=ht({inputs:{x:c},backend:t,attrs:{perm:d}}),u=wt(u.length,r)),At("sum",u,p.shape.length);const[f,m]=Tt(p.shape,u),g=Qt(p.dtype,"int32");let h=oe(t,f,g);const I=B(m),k=t.data.get(h.dataId).values,x=t.data.get(p.dataId).values;for(let b=0;b<k.length;++b){const y=b*I;let S=0;for(let N=0;N<I;++N)S+=x[y+N];k[b]=S}if(i){const b=Wt(h.shape,l),y=h;h=nt({inputs:{x:h},backend:t,attrs:{shape:b}}),t.disposeIntermediateTensorInfo(y)}return t.disposeIntermediateTensorInfo(c),d!=null&&t.disposeIntermediateTensorInfo(p),h}const _d={kernelName:ho,backendName:"cpu",kernelFunc:te};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bd(o){const{inputs:s,backend:t,attrs:n}=o,{equation:e}=n,a=s,{allDims:i,summedDims:c,idDims:r}=go(e,a.length);Io(i.length,r,a);const{path:l,steps:d}=ko(c,r),u=d.length;let p=null,f=i.length;const m=[];for(let g=0;g<u;++g){for(const h of d[g]){const{permutationIndices:I,expandDims:k}=bo(f,r[h]);let x;xo(I)?x=a[h]:(x=ht({inputs:{x:a[h]},backend:t,attrs:{perm:I}}),m.push(x));const b=x.shape.slice();for(let y=0;y<k.length;++y)b.splice(k[y],0,1);Ce(x.shape,b)||(x=nt({inputs:{x},backend:t,attrs:{shape:b}}),m.push(x)),p===null?p=x:(p=me({inputs:{a:x,b:p},backend:t}),m.push(p))}g<u-1&&(l[g]>=0&&(p=te({inputs:{x:p},backend:t,attrs:{axis:l[g]-(i.length-f),keepDims:!1}}),m.push(p)),f--)}for(const g of m)g!==p&&t.disposeIntermediateTensorInfo(g);return p}const Gd={kernelName:mo,backendName:"cpu",kernelFunc:Bd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qd(o){const{inputs:s,backend:t}=o,{dy:n,y:e}=s;G([n,e],"eluGrad");const a=new Float32Array(B(e.shape)),i=t.data.get(e.dataId).values,c=t.data.get(n.dataId).values;for(let r=0;r<i.length;++r){const l=i[r];l>=1?a[r]=c[r]:a[r]=c[r]*(l+1)}return t.makeTensorInfo(e.shape,"float32",a)}const jd={kernelName:yo,backendName:"cpu",kernelFunc:qd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ud=To,Kd=So,Xd=No,Yd=wo,Zd=vo,Qd=Co,Jd=Q(On,o=>{const s=Math.sign(o),t=Math.abs(o),n=1/(1+Ud*t);return s*(1-((((Qd*n+Zd)*n+Yd)*n+Xd)*n+Kd)*n*Math.exp(-t*t))}),tu={kernelName:On,backendName:"cpu",kernelFunc:Jd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ce(o){const{inputs:s,backend:t,attrs:n}=o,{input:e}=s,{dim:a}=n,i=e.shape.length,c=e.shape.slice();let r=a;return a<0&&(ut(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),r=i+a+1),c.splice(r,0,1),nt({inputs:{x:e},backend:t,attrs:{shape:c}})}const eu={kernelName:Mo,backendName:"cpu",kernelFunc:ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nu=it((o,s)=>o/s),Oe=ct(Pn,nu),Se={kernelName:Pn,backendName:"cpu",kernelFunc:Oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ns(o,s,t){const n=o.shape,e=n[0],a=n[1],i=t.data.get(o.dataId),c=i.complexTensorInfos.real,r=i.complexTensorInfos.imag,l=[e,a],d=B(l),u=ft("float32",d),p=ft("float32",d);for(let h=0;h<e;h++){const I=Pt({inputs:{x:c},backend:t,attrs:{begin:[h,0],size:[1,a]}}),k=Pt({inputs:{x:r},backend:t,attrs:{begin:[h,0],size:[1,a]}}),x=gt({inputs:{real:I,imag:k},backend:t}),{real:b,imag:y}=su(x,s,t),S=zt(b,y);for(let N=0;N<a;N++){const w=Wn(S,N);u[h*a+N]=w.real,p[h*a+N]=w.imag}t.disposeIntermediateTensorInfo(I),t.disposeIntermediateTensorInfo(k),t.disposeIntermediateTensorInfo(x)}const f=t.makeTensorInfo(l,"float32",u),m=t.makeTensorInfo(l,"float32",p),g=gt({inputs:{real:f,imag:m},backend:t});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),g}function su(o,s,t){const n=B(o.shape),e=t.data.get(o.dataId),a=t.data.get(e.complexTensorInfos.real.dataId).values,i=t.data.get(e.complexTensorInfos.imag.dataId).values;if(au(n)){const c=Ne(a,i,n,s,t),r=[o.shape[0],o.shape[1]];if(s){const l=t.makeTensorInfo(r,"float32",c.real),d=t.makeTensorInfo(r,"float32",c.imag),u=t.makeTensorInfo([],"float32",we(n,"float32")),p=St({inputs:{x:u},backend:t}),f=Se.kernelFunc({inputs:{a:l,b:u},backend:t}),m=Se.kernelFunc({inputs:{a:d,b:p},backend:t}),g=t.data.get(f.dataId).values,h=t.data.get(m.dataId).values;return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),{real:g,imag:h}}return c}else{const c=zt(a,i),r=ou(c,n,s);return Fo(r)}}function au(o){return(o&o-1)===0}function Ne(o,s,t,n,e){if(t===1)return{real:o,imag:s};const a=zt(o,s),i=t/2,c=Ro(a),r=c.real,l=c.imag,d=[r.length],u=e.makeTensorInfo(d,"float32",r),p=e.makeTensorInfo(d,"float32",l),f=gt({inputs:{real:u,imag:p},backend:e}),m=Do(a),g=m.real,h=m.imag,I=[g.length],k=e.makeTensorInfo(I,"float32",g),x=e.makeTensorInfo(I,"float32",h),b=gt({inputs:{real:k,imag:x},backend:e}),y=Ne(r,l,i,n,e),S=y.real,N=y.imag,w=[S.length],F=e.makeTensorInfo(w,"float32",S),R=e.makeTensorInfo(w,"float32",N),E=gt({inputs:{real:F,imag:R},backend:e}),P=Ne(g,h,i,n,e),v=P.real,D=P.imag,C=[v.length],T=e.makeTensorInfo(C,"float32",v),O=e.makeTensorInfo(C,"float32",D),M=gt({inputs:{real:T,imag:O},backend:e}),V=Vo(t,n),A=[V.real.length],W=e.makeTensorInfo(A,"float32",V.real),H=e.makeTensorInfo(A,"float32",V.imag),$=gt({inputs:{real:W,imag:H},backend:e}),L=me({inputs:{a:$,b:M},backend:e}),z=Ht({inputs:{a:E,b:L},backend:e}),_=Ve({inputs:{a:E,b:L},backend:e}),q=Ot({inputs:{input:z},backend:e}),j=Ot({inputs:{input:_},backend:e}),U=Lt({inputs:{input:z},backend:e}),X=Lt({inputs:{input:_},backend:e}),Y=_t({inputs:[q,j],backend:e,attrs:{axis:0}}),Z=_t({inputs:[U,X],backend:e,attrs:{axis:0}}),et=e.data.get(Y.dataId).values,st=e.data.get(Z.dataId).values;return e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(k),e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(F),e.disposeIntermediateTensorInfo(R),e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(T),e.disposeIntermediateTensorInfo(O),e.disposeIntermediateTensorInfo(M),e.disposeIntermediateTensorInfo(W),e.disposeIntermediateTensorInfo(H),e.disposeIntermediateTensorInfo($),e.disposeIntermediateTensorInfo(L),e.disposeIntermediateTensorInfo(z),e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(q),e.disposeIntermediateTensorInfo(U),e.disposeIntermediateTensorInfo(j),e.disposeIntermediateTensorInfo(X),e.disposeIntermediateTensorInfo(Y),e.disposeIntermediateTensorInfo(Z),{real:et,imag:st}}function ou(o,s,t){const n=new Float32Array(s*2);for(let e=0;e<s;e++){let a=0,i=0;for(let c=0;c<s;c++){const r=Oo(e*c,s,t),l=Wn(o,c);a+=l.real*r.real-l.imag*r.imag,i+=l.real*r.imag+l.imag*r.real}t&&(a/=s,i/=s),Eo(n,a,i,e)}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ru(o){const{inputs:s,backend:t}=o,{input:n}=s,e=B(n.shape),a=n.shape[n.shape.length-1],i=e/a,c=nt({inputs:{x:n},backend:t,attrs:{shape:[i,a]}}),r=Ns(c,!1,t),l=nt({inputs:{x:r},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(r),l}const iu={kernelName:Po,backendName:"cpu",kernelFunc:ru};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pe(o){const{backend:s,attrs:t}=o,{shape:n,value:e,dtype:a}=t,i=a||Ao(e),c=dt(i,B(n));return lu(c,e,i),s.makeTensorInfo(n,i,c)}const cu={kernelName:Wo,backendName:"cpu",kernelFunc:Pe};function lu(o,s,t){o.fill(s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const du={kernelName:$o,backendName:"cpu",kernelFunc:({inputs:o,attrs:s,backend:t})=>{const{image:n}=o,e=t,a=ft(n.dtype,B(n.shape)),[i,c,r,l]=n.shape,d=e.data.get(n.dataId).values;for(let p=0;p<i;p++){const f=p*r*c*l;for(let m=0;m<c;m++){const g=m*(r*l);for(let h=0;h<r;h++){const I=h*l;for(let k=0;k<l;k++){const x=Math.round(r-h-1),b=f+g+I+k;let y=d[b];if(x>=0&&x<r){const S=x*l,N=f+g+S+k;y=d[N]}a[b]=y}}}}return{dataId:e.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uu=it((o,s)=>Math.floor(o/s)),pu=ct(An,uu,null,"int32"),fu={kernelName:An,backendName:"cpu",kernelFunc:pu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hu(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,filter:a,bias:i,preluActivationWeights:c}=s,{strides:r,pad:l,dataFormat:d,dilations:u,dimRoundingMode:p,activation:f,leakyreluAlpha:m}=n;let g=ys({inputs:{x:e,filter:a},backend:t,attrs:{strides:r,pad:l,dataFormat:d,dilations:u,dimRoundingMode:p}});if(i){const h=g;if(d==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const I=nt({inputs:{x:i},backend:t,attrs:{shape:[i.shape[0],1,1]}});g=Ht({inputs:{a:g,b:I},backend:t}),t.disposeIntermediateTensorInfo(I)}else g=Ht({inputs:{a:g,b:i},backend:t});t.disposeIntermediateTensorInfo(h)}if(f){const h=g;if(d==="NCHW"&&f==="prelu"&&c.shape.length===1&&c.shape[0]!==1){const I=nt({inputs:{x:c},backend:t,attrs:{shape:[c.shape[0],1,1]}});g=ie(t,g,f,I,m),t.disposeIntermediateTensorInfo(I)}else g=ie(t,g,f,c,m);t.disposeIntermediateTensorInfo(h)}return g}const mu={kernelName:zo,backendName:"cpu",kernelFunc:hu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gu(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,filter:a,bias:i,preluActivationWeights:c}=s,{strides:r,pad:l,dataFormat:d,dilations:u,dimRoundingMode:p,activation:f,leakyreluAlpha:m}=n;let g=Ss({inputs:{x:e,filter:a},backend:t,attrs:{strides:r,pad:l,dataFormat:d,dilations:u,dimRoundingMode:p}});if(i){const h=g;g=Ht({inputs:{a:g,b:i},backend:t}),t.disposeIntermediateTensorInfo(h)}if(f){const h=g;g=ie(t,g,f,c,m),t.disposeIntermediateTensorInfo(h)}return g}const Iu={kernelName:Ho,backendName:"cpu",kernelFunc:gu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ku(o){const{inputs:s,backend:t}=o,{params:n,indices:e}=s,a=B(n.shape),i=e.shape,c=i[i.length-1],[r,l,d,u]=_o(n,e);if(l===0)return t.makeTensorInfo(r,n.dtype,[]);const p=t.data.get(e.dataId).values,f=t.bufferSync(n),m=Hi(p,f,n.dtype,l,c,d,u,n.shape,a);return t.makeTensorInfo(r,n.dtype,m.values)}const bu={kernelName:Lo,backendName:"cpu",kernelFunc:ku};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xu(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,indices:a}=s,{axis:i,batchDims:c}=n;G([e,a],"gatherV2");const r=mt(i,e.shape)[0],l=t.data.get(a.dataId).values,d=e.shape[r];for(let b=0;b<l.length;++b){const y=l[b];ut(y<=d-1&&y>=0,()=>`GatherV2: the index value ${y} is not in [0, ${d-1}]`)}let u=c;c==null&&(u=0);const p=B(a.shape),f=Go(e,a,r,u),m=nt({inputs:{x:e},backend:t,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),g=nt({inputs:{x:a},backend:t,attrs:{shape:[f.batchSize,p/f.batchSize]}}),h=[f.batchSize,f.outerSize,p/f.batchSize,f.sliceSize],I=t.bufferSync(g),k=t.bufferSync(m),x=Li(k,I,h);return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),t.makeTensorInfo(f.outputShape,x.dtype,x.values)}const yu={kernelName:Bo,backendName:"cpu",kernelFunc:xu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Su(o){const{inputs:s,backend:t}=o,{input:n}=s,e=B(n.shape),a=n.shape[n.shape.length-1],i=e/a,c=nt({inputs:{x:n},backend:t,attrs:{shape:[i,a]}}),r=Ns(c,!0,t),l=nt({inputs:{x:r},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(r),l}const Nu={kernelName:qo,backendName:"cpu",kernelFunc:Su};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wu=Q($n,o=>Number.isFinite(o)?1:0,"bool"),vu={kernelName:$n,backendName:"cpu",kernelFunc:wu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cu=Q(zn,o=>Math.abs(o)===1/0?1:0,"bool"),Tu={kernelName:zn,backendName:"cpu",kernelFunc:Cu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mu=Q(Hn,o=>Number.isNaN(o)?1:0,"bool"),Fu={kernelName:Hn,backendName:"cpu",kernelFunc:Mu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ru(o){const{backend:s,attrs:t}=o,{start:n,stop:e,num:a}=t,i=tc(n,e,a);return s.makeTensorInfo([i.length],"float32",i)}const Du={kernelName:jo,backendName:"cpu",kernelFunc:Ru};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vu=Q(Ln,o=>Math.log1p(o)),Eu={kernelName:Ln,backendName:"cpu",kernelFunc:Vu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ou=it((o,s)=>o&&s),Pu=ct(_n,Ou,null,"bool"),Wu={kernelName:_n,backendName:"cpu",kernelFunc:Pu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Au=Q(Bn,o=>o?0:1,"bool"),$u={kernelName:Bn,backendName:"cpu",kernelFunc:Au};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zu=it((o,s)=>o||s),Hu=ct(Gn,zu,null,"bool"),Lu={kernelName:Gn,backendName:"cpu",kernelFunc:Hu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _u(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{depthRadius:a,bias:i,alpha:c,beta:r}=n;G(e,"LRN");const l=e.shape[3],d=l-1,u=t.data.get(e.dataId).values,p=B(e.shape),f=new Float32Array(p);function m(g){const h=g%l;let I=g-h+Math.max(0,h-a);const k=g-h+Math.min(h+a,d);let x=0;for(;I<=k;I++){const b=u[I];x+=b*b}return x}for(let g=0;g<p;g++){const h=m(g),I=u[g]*Math.pow(i+c*h,-r);f[g]=I}return t.makeTensorInfo(e.shape,e.dtype,f)}const Bu={kernelName:Uo,backendName:"cpu",kernelFunc:_u};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gu(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,y:a,dy:i}=s,{depthRadius:c,bias:r,alpha:l,beta:d}=n;G(i,"LRNGrad");const u=B(i.shape),p=i.shape[3],f=t.data.get(i.dataId).values,m=t.data.get(e.dataId).values,g=t.data.get(a.dataId).values,h=new Float32Array(u),I=u;for(let k=0;k<I;k++){const x=k%p,b=k-x+Math.max(0,x-c),y=k-x+Math.min(p,x+c+1);let S=0;for(let N=b;N<y;N++)S+=Math.pow(m[N],2);S=l*S+r;for(let N=b;N<y;N++){let w=-2*l*d*m[N]*g[k]/S;k===N&&(w+=Math.pow(S,-d)),w*=f[k],h[N]+=w}}return t.makeTensorInfo(i.shape,e.dtype,h)}const qu={kernelName:Ko,backendName:"cpu",kernelFunc:Gu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ws(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{reductionIndices:a,keepDims:i}=n,c=t;let r=e.shape;const l=r.length,d=mt(a,r);let u=d;const p=Nt(u,l);let f=c.data.get(e.dataId).values;if(p!=null){const b=new Array(l);for(let y=0;y<b.length;y++)b[y]=r[p[y]];f=ls(f,r,e.dtype,p,b),u=wt(u.length,l),r=b}G(e,"max"),At("max",u,l);const[m,g]=Tt(r,u),h=B(g),I=ac(f,h,m,e.dtype),k=c.write(I,m,e.dtype);let x=m;return i&&(x=Wt(m,d)),{dataId:k,shape:x,dtype:e.dtype}}const ju={kernelName:Xo,backendName:"cpu",kernelFunc:ws};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uu(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s;G(e,"maxPool");const{filterSize:a,strides:i,pad:c,dimRoundingMode:r}=n,l=1;ut(ve(i,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);const d=Jt(e.shape,a,i,l,c,r);let u;if(d.filterWidth===1&&d.filterHeight===1&&Ce(d.inShape,d.outShape))u=St({inputs:{x:e},backend:t});else{const p=t.data.get(e.dataId).values,f=K(e.shape),m=Ee(p,e.shape,e.dtype,f,d,"max");u=t.makeTensorInfo(d.outShape,e.dtype,m.values)}return u}const Ku={kernelName:Yo,backendName:"cpu",kernelFunc:Uu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xu(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{filterSize:a,strides:i,pad:c,dimRoundingMode:r,dataFormat:l}=n;G(e,"maxPool3d");const d=fe(e.shape,a,i,1,c,r,l),u=t.data.get(e.dataId).values,p=xs(u,e.shape,e.dtype,K(e.shape),d,"max");return t.makeTensorInfo(p.shape,"float32",p.values)}const Yu={kernelName:Zo,backendName:"cpu",kernelFunc:Xu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zu(o){const{inputs:s,backend:t,attrs:n}=o,{dy:e,input:a}=s,{filterSize:i,strides:c,pad:r,dimRoundingMode:l}=n;G([e,a],"maxPool3DGrad");const d=fe(a.shape,i,c,1,r,l),u=t.bufferSync(a),p=$l(u,d),f=d.strideDepth,m=d.strideHeight,g=d.strideWidth,h=d.dilationDepth,I=d.dilationHeight,k=d.dilationWidth,x=d.effectiveFilterDepth,b=d.effectiveFilterHeight,y=d.effectiveFilterWidth,S=x-1-d.padInfo.front,N=y-1-d.padInfo.left,w=b-1-d.padInfo.top,F=tt(a.shape,"float32"),R=t.bufferSync(e);for(let E=0;E<d.batchSize;++E)for(let P=0;P<d.inChannels;++P)for(let v=0;v<d.inDepth;++v)for(let D=0;D<d.inHeight;++D)for(let C=0;C<d.inWidth;++C){const T=v-S,O=D-w,M=C-N;let V=0;for(let A=0;A<x;A+=h){const W=(T+A)/f;if(!(W<0||W>=d.outDepth||Math.floor(W)!==W))for(let H=0;H<b;H+=I){const $=(O+H)/m;if(!($<0||$>=d.outHeight||Math.floor($)!==$))for(let L=0;L<y;L+=k){const z=(M+L)/g;if(z<0||z>=d.outWidth||Math.floor(z)!==z)continue;const _=x*b*y-1-p.get(E,W,$,z,P),q=A*b*y+H*y+L,j=_===q?1:0;if(j===0)continue;const U=R.get(E,W,$,z,P);V+=U*j}}}F.set(V,E,v,D,C,P)}return t.makeTensorInfo(F.shape,F.dtype,F.values)}const Qu={kernelName:Qo,backendName:"cpu",kernelFunc:Zu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ju(o){const{inputs:s,backend:t,attrs:n}=o,{dy:e,input:a,output:i}=s,c=a;G([a,i],"maxPoolGrad");const{filterSize:r,strides:l,pad:d,dimRoundingMode:u}=n,p=Jt(c.shape,r,l,1,d,u),f=t.data.get(c.dataId).values,m=tt(p.outShape,c.dtype,bs(f,c.shape,c.dtype,p).values),g=p.strideHeight,h=p.strideWidth,I=p.dilationHeight,k=p.dilationWidth,x=p.effectiveFilterHeight,b=p.effectiveFilterWidth,y=b-1-p.padInfo.left,S=x-1-p.padInfo.top,N=tt(c.shape,"float32"),w=t.data.get(e.dataId).values,F=tt(e.shape,"float32",w);for(let R=0;R<p.batchSize;++R)for(let E=0;E<p.inChannels;++E)for(let P=0;P<p.inHeight;++P)for(let v=0;v<p.inWidth;++v){const D=P-S,C=v-y;let T=0;for(let O=0;O<x;O+=I){const M=(D+O)/g;if(!(M<0||M>=p.outHeight||Math.floor(M)!==M))for(let V=0;V<b;V+=k){const A=(C+V)/h;if(A<0||A>=p.outWidth||Math.floor(A)!==A)continue;const W=x*b-1-m.get(R,M,A,E),H=O*b+V,$=W===H?1:0;if($===0)continue;const L=F.get(R,M,A,E);T+=L*$}}N.set(T,R,P,v,E)}return t.makeTensorInfo(N.shape,N.dtype,N.values)}const tp={kernelName:Jo,backendName:"cpu",kernelFunc:Ju};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ep(o,s,t,n,e){const a=K(s),i=Ee(o,s,t,a,e,"max"),c=bs(o,s,t,e,!0,n);return[i.values,c.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const np={kernelName:tr,backendName:"cpu",kernelFunc:({inputs:o,attrs:s,backend:t})=>{const{x:n}=o,{filterSize:e,strides:a,pad:i,includeBatchInIndex:c}=s,r=t;G(n,"MaxPoolWithArgmax");const l=r.data.get(n.dataId).values,d=Jt(n.shape,e,a,[1,1],i),[u,p]=ep(l,n.shape,n.dtype,c,d),f=r.write(u,d.outShape,n.dtype),m=r.write(p,d.outShape,n.dtype);return[{dataId:f,shape:d.outShape,dtype:n.dtype},{dataId:m,shape:d.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sp(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{axis:a,keepDims:i}=n,c=mt(a,e.shape),l=Tt(e.shape,c)[1],d=B(l),u=[],p=t.makeTensorInfo([],"float32",new Float32Array([d]));u.push(p);const f=Vt({inputs:{x:e},backend:t,attrs:{dtype:"float32"}});u.push(f);const m=Oe({inputs:{a:f,b:p},backend:t});u.push(m);const g=te({inputs:{x:m},backend:t,attrs:{axis:a,keepDims:i}});return u.forEach(h=>t.disposeIntermediateTensorInfo(h)),g}const ap={kernelName:er,backendName:"cpu",kernelFunc:sp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function op(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{axis:a,keepDims:i}=n;G(e,"min");const c=mt(a,e.shape);let r=c;const l=Nt(r,e.shape.length);let d=e;l!=null&&(d=ht({inputs:{x:e},backend:t,attrs:{perm:l}}),r=wt(r.length,e.shape.length)),At("min",r,d.shape.length);const[u,p]=Tt(d.shape,r),f=B(p),m=It(B(u),d.dtype),g=t.data.get(d.dataId).values;for(let I=0;I<m.length;++I){const k=I*f;let x=g[k];for(let b=0;b<f;++b){const y=g[k+b];(Number.isNaN(y)||y<x)&&(x=y)}m[I]=x}l!=null&&t.disposeIntermediateTensorInfo(d);const h=t.makeTensorInfo(u,d.dtype,m);if(i){const I=Wt(u,c),k=nt({inputs:{x:h},backend:t,attrs:{shape:I}});return t.disposeIntermediateTensorInfo(h),k}return h}const rp={kernelName:nr,backendName:"cpu",kernelFunc:op};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ip(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{paddings:a,mode:i}=n;G(e,"mirrorPad");const c=a.map((x,b)=>x[0]+e.shape[b]+x[1]),r=a.map(x=>x[0]),l=a.map((x,b)=>x[0]+e.shape[b]),d=i==="reflect"?0:1,u=t.data.get(e.dataId).values,p=e.shape.length,f=K(e.shape),m=B(c),g=c.length,h=K(c),I=ft(e.dtype,m);for(let x=0;x<m;x++){let b=Bt(x,g,h);for(let S=0;S<g;S++)b[S]<r[S]?b[S]=r[S]*2-b[S]-d:b[S]>=l[S]&&(b[S]=(l[S]-1)*2-b[S]+d);b=b.map((S,N)=>S-r[N]);const y=yt(b,p,f);I[x]=u[y]}return{dataId:t.write(I,c,e.dtype),shape:c,dtype:e.dtype}}const cp={kernelName:sr,backendName:"cpu",kernelFunc:ip};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lp=it((o,s)=>{const t=o%s;return o<0&&s<0||o>=0&&s>=0?t:(t+s)%s}),dp=ct(qn,lp),up={kernelName:qn,backendName:"cpu",kernelFunc:dp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vs(o){const{inputs:s,backend:t,attrs:n}=o,{logits:e}=s,{dim:a}=n,i=e.shape.length;let c=a;if(c===-1&&(c=i-1),c!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${c}`);const r=mt([c],e.shape),l=ws({inputs:{x:e},backend:t,attrs:{reductionIndices:r,keepDims:!1}}),d=Wt(l.shape,r),u=nt({inputs:{x:l},backend:t,attrs:{shape:d}}),p=Ve({inputs:{a:e,b:u},backend:t}),f=is({inputs:{x:p},backend:t}),m=te({inputs:{x:f},backend:t,attrs:{axis:r,keepDims:!1}}),g=nt({inputs:{x:m},backend:t,attrs:{shape:d}}),h=Oe({inputs:{a:f,b:g},backend:t});return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),h}const pp={kernelName:ar,backendName:"cpu",kernelFunc:vs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fp(o){const{inputs:s,backend:t,attrs:n}=o,{logits:e}=s,{numSamples:a,seed:i,normalized:c}=n;G(e,"multinomial");const r=c?e:vs({inputs:{logits:e},backend:t,attrs:{dim:-1}}),l=r.shape[0],d=r.shape[1],u=t.data.get(r.dataId).values,p=[l,a],f=It(B(p),"int32");for(let m=0;m<l;++m){const g=m*d,h=new Float32Array(d-1);h[0]=u[g];for(let x=1;x<h.length;++x)h[x]=h[x-1]+u[g+x];const I=rr.alea(i.toString()),k=m*a;for(let x=0;x<a;++x){const b=I();f[k+x]=h.length;for(let y=0;y<h.length;y++)if(b<h[y]){f[k+x]=y;break}}}return c||t.disposeIntermediateTensorInfo(r),t.makeTensorInfo(p,"int32",f)}const hp={kernelName:or,backendName:"cpu",kernelFunc:fp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mp=cr;function gp(o){const{inputs:s,backend:t,attrs:n}=o,{boxes:e,scores:a}=s,{maxOutputSize:i,iouThreshold:c,scoreThreshold:r}=n;G(e,"NonMaxSuppression");const l=t.data.get(e.dataId).values,d=t.data.get(a.dataId).values,{selectedIndices:u}=mp(l,d,i,c,r);return t.makeTensorInfo([u.length],"int32",new Int32Array(u))}const Ip={kernelName:ir,backendName:"cpu",kernelFunc:gp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kp=dr;function bp(o){const{inputs:s,backend:t,attrs:n}=o,{boxes:e,scores:a}=s,{maxOutputSize:i,iouThreshold:c,scoreThreshold:r,padToMaxOutputSize:l}=n;G(e,"NonMaxSuppressionPadded");const d=t.data.get(e.dataId).values,u=t.data.get(a.dataId).values,{selectedIndices:p,validOutputs:f}=kp(d,u,i,c,r,l);return[t.makeTensorInfo([p.length],"int32",new Int32Array(p)),t.makeTensorInfo([],"int32",new Int32Array([f]))]}const xp={kernelName:lr,backendName:"cpu",kernelFunc:bp};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yp=pr;function Sp(o){const{inputs:s,backend:t,attrs:n}=o,{boxes:e,scores:a}=s,{maxOutputSize:i,iouThreshold:c,scoreThreshold:r,softNmsSigma:l}=n;G(e,"NonMaxSuppressionWithScore");const d=t.data.get(e.dataId).values,u=t.data.get(a.dataId).values,p=i,f=c,m=r,g=l,{selectedIndices:h,selectedScores:I}=yp(d,u,p,f,m,g);return[t.makeTensorInfo([h.length],"int32",new Int32Array(h)),t.makeTensorInfo([I.length],"float32",new Float32Array(I))]}const Np={kernelName:ur,backendName:"cpu",kernelFunc:Sp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wp(o){const{inputs:s,backend:t,attrs:n}=o,{indices:e}=s,{dtype:a,depth:i,onValue:c,offValue:r}=n;G(e,"oneHot");const l=B(e.shape),d=new Float32Array(l*i);d.fill(r);const u=t.data.get(e.dataId).values;for(let p=0;p<l;++p)u[p]>=0&&u[p]<i&&(d[p*i+u[p]]=c);return t.makeTensorInfo([...e.shape,i],a,d)}const vp={kernelName:fr,backendName:"cpu",kernelFunc:wp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function le(o){const{inputs:s,backend:t}=o,{x:n}=s;if(n.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(n.dtype==="complex64"){const e=Ot({inputs:{input:n},backend:t}),a=le({inputs:{x:e},backend:t}),i=Lt({inputs:{input:n},backend:t}),c=le({inputs:{x:i},backend:t}),r=gt({inputs:{real:a,imag:c},backend:t});return t.disposeIntermediateTensorInfo(e),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(c),r}else return Pe({backend:t,attrs:{shape:n.shape,value:0,dtype:n.dtype}})}const Cp={kernelName:hr,backendName:"cpu",kernelFunc:le};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cs(o){const{inputs:s,backend:t}=o,{x:n}=s;if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(n.dtype==="complex64"){const e=Ot({inputs:{input:n},backend:t}),a=Cs({inputs:{x:e},backend:t}),i=Lt({inputs:{input:n},backend:t}),c=le({inputs:{x:i},backend:t}),r=gt({inputs:{real:a,imag:c},backend:t});return t.disposeIntermediateTensorInfo(e),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(c),r}else return Pe({backend:t,attrs:{shape:n.shape,value:1,dtype:n.dtype}})}const Tp={kernelName:mr,backendName:"cpu",kernelFunc:Cs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ts(o){const{inputs:s,backend:t,attrs:n}=o,{axis:e}=n;if(s.length===1)return ce({inputs:{input:s[0]},backend:t,attrs:{dim:e}});const a=s[0].shape,i=s[0].dtype;s.forEach(d=>{Ir(a,d.shape,"All tensors passed to stack must have matching shapes"),ut(i===d.dtype,()=>"All tensors passed to stack must have matching dtypes")});const c=[],r=s.map(d=>{const u=ce({inputs:{input:d},backend:t,attrs:{dim:e}});return c.push(u),u}),l=_t({inputs:r,backend:t,attrs:{axis:e}});return c.forEach(d=>t.disposeIntermediateTensorInfo(d)),l}const Mp={kernelName:gr,backendName:"cpu",kernelFunc:Ts};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fp(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{paddings:a,constantValue:i}=n;G(e,"pad");const c=a.map((k,x)=>k[0]+e.shape[x]+k[1]),r=a.map(k=>k[0]),l=t.data.get(e.dataId).values,d=B(e.shape),u=e.shape.length,p=K(e.shape),f=B(c),m=c.length,g=K(c),h=ft(e.dtype,f);i!==0&&h.fill(i);for(let k=0;k<d;k++){const b=Bt(k,u,p).map((S,N)=>S+r[N]),y=yt(b,m,g);h[y]=l[k]}return{dataId:t.write(h,c,e.dtype),shape:c,dtype:e.dtype}}const Ms={kernelName:kr,backendName:"cpu",kernelFunc:Fp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rp=it((o,s)=>Math.pow(o,s)),Dp=ct(jn,Rp),Vp={kernelName:jn,backendName:"cpu",kernelFunc:Dp};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ep(o){const{inputs:s,backend:t,attrs:n}=o,{paramsNestedSplits:e,paramsDenseValues:a,indices:i}=s,c=e.map(h=>t.data.get(h.dataId).values),r=e.map(h=>h.shape),l=t.data.get(a.dataId).values,d=t.data.get(i.dataId).values,[u,p,f]=Fc(c,r,l,a.shape,a.dtype,d,i.shape),m=u.map(h=>t.makeTensorInfo([h.length],"int32",h)),g=t.makeTensorInfo(f,a.dtype,p);return m.concat([g])}const Op={kernelName:br,backendName:"cpu",kernelFunc:Ep};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pp(o){const{inputs:s,backend:t,attrs:n}=o,{shape:e,values:a,defaultValue:i,rowPartitionTensors:c}=s,{rowPartitionTypes:r}=n,l=t.data.get(e.dataId).values,d=t.data.get(a.dataId).values,u=t.data.get(i.dataId).values,p=c.map(h=>t.data.get(h.dataId).values),f=c.map(h=>h.shape),[m,g]=Rc(l,e.shape,d,a.shape,a.dtype,u,i.shape,p,f,r);return t.makeTensorInfo(m,a.dtype,g)}const Wp={kernelName:xr,backendName:"cpu",kernelFunc:Pp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ap(o){const{backend:s,attrs:t}=o,{start:n,stop:e,dtype:a,step:i}=t,c=Dc(n,e,i,a);return s.makeTensorInfo([c.length],a,c)}const $p={kernelName:yr,backendName:"cpu",kernelFunc:Ap};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zp=Q(Un,o=>1/o),Hp={kernelName:Un,backendName:"cpu",kernelFunc:zp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lp(o){const{inputs:s,backend:t,attrs:n}=o,{images:e}=s,{alignCorners:a,halfPixelCenters:i,size:c}=n;G(e,"resizeBilinear");const r=K(e.shape),[l,d]=c,[u,p,f,m]=e.shape,g=t.data.get(e.dataId).values,h=new Float32Array(B([u,l,d,m])),I=[a&&l>1?p-1:p,a&&d>1?f-1:f],k=[a&&l>1?l-1:l,a&&d>1?d-1:d];let x=0;const b=I[0]/k[0],y=I[1]/k[1];for(let S=0;S<u;S++)for(let N=0;N<l;N++){let w;i?w=b*(N+.5)-.5:w=b*N;const F=Math.max(0,Math.floor(w)),R=w-F,E=Math.min(p-1,Math.ceil(w)),P=S*r[0]+F*r[1],v=S*r[0]+E*r[1];for(let D=0;D<d;D++){let C;i?C=y*(D+.5)-.5:C=y*D;const T=Math.max(0,Math.floor(C)),O=C-T,M=Math.min(f-1,Math.ceil(C)),V=P+T*r[2],A=v+T*r[2],W=P+M*r[2],H=v+M*r[2];for(let $=0;$<m;$++){const L=g[V+$],z=g[A+$],_=g[W+$],q=g[H+$],j=L+(_-L)*O,U=z+(q-z)*O,X=j+(U-j)*R;h[x++]=X}}}return t.makeTensorInfo([u,l,d,m],"float32",h)}const _p={kernelName:Sr,backendName:"cpu",kernelFunc:Lp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bp(o){const{inputs:s,backend:t,attrs:n}=o,{images:e,dy:a}=s,{alignCorners:i}=n;G([a,e],"resizeBilinearGrad");const c=K(e.shape),[r,l,d,u]=e.shape,[,p,f]=a.shape,m=new Float32Array(r*l*d*u),g=[i&&p>1?l-1:l,i&&f>1?d-1:d],h=[i&&p>1?p-1:p,i&&f>1?f-1:f],I=g[0]/h[0],k=g[1]/h[1],x=t.data.get(a.dataId).values;let b=0;for(let y=0;y<r;y++){const S=y*c[0];for(let N=0;N<p;N++){const w=N*I,F=Math.floor(w),R=Math.min(Math.ceil(w),l-1),E=S+F*c[1],P=S+R*c[1],v=w-F,D=1-v;for(let C=0;C<f;C++){const T=C*k,O=Math.floor(T),M=Math.min(Math.ceil(T),d-1),V=T-O,A=1-V,W=E+O*c[2],H=E+M*c[2],$=P+O*c[2],L=P+M*c[2],z=D*A,_=D*V,q=v*A,j=v*V;for(let U=0;U<u;U++){const X=x[b++];m[W+U]+=X*z,m[H+U]+=X*_,m[$+U]+=X*q,m[L+U]+=X*j}}}}return t.makeTensorInfo([r,d,l,u],"float32",m)}const Gp={kernelName:Nr,backendName:"cpu",kernelFunc:Bp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qp(o){const{inputs:s,backend:t,attrs:n}=o,{images:e}=s,{alignCorners:a,halfPixelCenters:i,size:c}=n;G(e,"resizeNearestNeighbor");const r=K(e.shape),[l,d]=c,[u,p,f,m]=e.shape,g=t.data.get(e.dataId).values,h=new Float32Array(u*l*d*m),I=[a&&l>1?p-1:p,a&&d>1?f-1:f],k=[a&&l>1?l-1:l,a&&d>1?d-1:d],x=I[0]/k[0],b=I[1]/k[1];let y=0;for(let S=0;S<u;S++){const N=S*r[0];for(let w=0;w<l;w++){const F=i?x*(w+.5):x*w;let R=Math.min(p-1,a?Math.round(F):Math.floor(F));i&&(R=Math.max(0,R));const E=N+R*r[1];for(let P=0;P<d;P++){const v=i?b*(P+.5):b*P;let D=Math.min(f-1,a?Math.round(v):Math.floor(v));i&&(D=Math.max(0,D));const C=E+D*r[2];for(let T=0;T<m;T++){const O=g[C+T];h[y++]=O}}}}return t.makeTensorInfo([u,l,d,m],e.dtype,h)}const jp={kernelName:wr,backendName:"cpu",kernelFunc:qp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Up(o){const{inputs:s,backend:t,attrs:n}=o,{images:e,dy:a}=s,{alignCorners:i}=n;G([a,e],"resizeNearestNeighborGrad");const c=K(e.shape),r=K(a.shape),[l,d,u,p]=e.shape,[,f,m]=a.shape,g=new Float32Array(l*d*u*p),h=t.data.get(a.dataId).values,I=[i&&f>1?d-1:d,i&&m>1?u-1:u],k=[i&&f>1?f-1:f,i&&m>1?m-1:m],x=I[0]/k[0],b=I[1]/k[1],y=1/x,S=1/b,N=Math.ceil(y)*2+2,w=Math.ceil(S)*2+2;for(let F=0;F<l;F++){const R=F*c[0];for(let E=0;E<d;E++){const P=R+E*c[1],v=Math.floor(E*y),D=Math.floor(v-N/2);for(let C=0;C<u;C++){const T=P+C*c[2],O=Math.floor(C*S),M=Math.floor(O-w/2);for(let V=0;V<p;V++){let A=0;for(let W=0;W<N;W++){const H=W+D;if(H<0||H>=f)continue;const $=R+H*r[1],L=H*x,z=Math.min(d-1,i?Math.round(L):Math.floor(L));if(E===z)for(let _=0;_<w;_++){const q=_+M;if(q<0||q>=m)continue;const j=$+q*r[2],U=q*b,X=Math.min(u-1,i?Math.round(U):Math.floor(U));C===X&&(A+=h[j+V])}}g[T+V]=A}}}}return t.makeTensorInfo(e.shape,e.dtype,g)}const Kp={kernelName:vr,backendName:"cpu",kernelFunc:Up};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xp(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{dims:a}=n;G(e,"reverse");const i=e.shape.length,c=mt(a,e.shape);if(i===0)return St({inputs:{x:e},backend:t});const r=new pt(e.shape,e.dtype),l=t.bufferSync(e);for(let d=0;d<r.size;d++){const u=r.indexToLoc(d),p=u.slice();c.forEach(f=>p[f]=e.shape[f]-1-p[f]),r.set(l.get(...p),...u)}return t.makeTensorInfo(r.shape,r.dtype,r.values)}const Yp={kernelName:Cr,backendName:"cpu",kernelFunc:Xp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zp={kernelName:Tr,backendName:"cpu",kernelFunc:({inputs:o,attrs:s,backend:t})=>{const{image:n}=o,{radians:e,fillValue:a,center:i}=s,c=t,r=ft(n.dtype,B(n.shape)),[l,d,u,p]=n.shape,[f,m]=Mr(i,d,u),g=255,h=Math.sin(e),I=Math.cos(e),k=c.data.get(n.dataId).values;for(let b=0;b<l;b++){const y=b*u*d*p;for(let S=0;S<d;S++){const N=S*(u*p);for(let w=0;w<u;w++){const F=w*p;for(let R=0;R<p;R++){const E=[l,S,w,R],P=E[2],v=E[1];let D=(P-f)*I-(v-m)*h,C=(P-f)*h+(v-m)*I;D=Math.round(D+f),C=Math.round(C+m);let T=a;if(typeof a!="number"&&(R===3?T=g:T=a[R]),D>=0&&D<u&&C>=0&&C<d){const M=C*(u*p),V=D*p,A=y+M+V+R;T=k[A]}const O=y+N+F+R;r[O]=T}}}}return{dataId:c.write(r,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qp=Q(Kn,o=>{const s=Math.floor(o);return o-s<.5?Math.floor(o):o-s>.5?Math.ceil(o):s%2===0?s:s+1}),Jp={kernelName:Kn,backendName:"cpu",kernelFunc:Qp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tf(o){const{inputs:s,backend:t,attrs:n}=o,{indices:e,updates:a}=s,{shape:i}=n,{sliceRank:c,numUpdates:r,sliceSize:l,strides:d,outputSize:u}=Xn(a,e,i),p=!0,f=t.bufferSync(e),m=t.bufferSync(a),g=Xt(f,m,i,u,l,r,c,d,0,p);return t.makeTensorInfo(i,g.dtype,g.values)}const ef={kernelName:Fr,backendName:"cpu",kernelFunc:tf};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nf(o,s){let t=0,n=o.length,e=0;for(;t<n;)e=Math.floor((t+n)/2),o[e]<s?t=e+1:n=e;return n}function sf(o,s){let t=0,n=o.length,e=0;for(;t<n;)e=Math.floor((t+n)/2),o[e]<=s?t=e+1:n=e;return n}function af(o,s,t,n,e,a){const i=dt("int32",t*e);for(let c=0;c<t;++c){const r=o.slice(c*n,(c+1)*n),l=c*e;for(let d=0;d<e;++d)i[l+d]=a==="left"?nf(r,s[d+l]):sf(r,s[d+l])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function of(o){const{inputs:s,backend:t,attrs:n}=o,{sortedSequence:e,values:a}=s,{side:i}=n,c=t.data.get(e.dataId).values,r=t.data.get(a.dataId).values,l=af(c,r,e.shape[0],e.shape[1],a.shape[1],i);return t.makeTensorInfo(a.shape,"int32",l)}const rf={kernelName:Rr,backendName:"cpu",kernelFunc:of};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cf(o){const{inputs:s,backend:t}=o,{condition:n,t:e,e:a}=s;G([n,e,a],"select");const i=n.shape.length,c=t.data.get(n.dataId).values,r=t.data.get(e.dataId).values,l=t.data.get(a.dataId).values,d=Qt(e.dtype,a.dtype),u=It(B(e.shape),d);let p=0;const f=i===0||i>1||e.shape.length===1?1:B(e.shape.slice(1));for(let m=0;m<c.length;m++)for(let g=0;g<f;g++)c[m]===1?u[p++]=r[m]:u[p++]=l[m];return t.makeTensorInfo(e.shape,d,u)}const lf={kernelName:Dr,backendName:"cpu",kernelFunc:cf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const df=Vr,uf=Er,pf=Q(Yn,o=>o>=0?uf*o:df*(Math.exp(o)-1)),ff={kernelName:Yn,backendName:"cpu",kernelFunc:pf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hf=Q(Zn,o=>o<0?-1:o>0?1:0),mf={kernelName:Zn,backendName:"cpu",kernelFunc:hf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gf=Q(Qn,o=>Math.sin(o)),If={kernelName:Qn,backendName:"cpu",kernelFunc:gf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kf=Q(Jn,o=>Math.sinh(o)),bf={kernelName:Jn,backendName:"cpu",kernelFunc:kf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xf=11920928955078125e-23,je=Math.log(xf)+2,yf=Q(ts,o=>{const s=o>-je,t=o<je,n=Math.exp(o);let e;return t?e=n:s?e=o:e=Math.log(1+n),e}),Sf={kernelName:ts,backendName:"cpu",kernelFunc:yf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nf(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{blockShape:a,paddings:i}=n;G([e],"spaceToBatchND");const c=B(a),r=[[0,0]];r.push(...i);for(let S=1+a.length;S<e.shape.length;++S)r.push([0,0]);const l=Ms.kernelFunc({inputs:{x:e},backend:t,attrs:{paddings:r,constantValue:0}}),d=Cn(l.shape,a,c,!1),u=Tn(d.length,a.length,!1),p=Mn(l.shape,a,c,!1),g=nt({inputs:{x:l},backend:t,attrs:{shape:d}}),k=ht({inputs:{x:g},backend:t,attrs:{perm:u}}),y=nt({inputs:{x:k},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(k),y}const wf={kernelName:Or,backendName:"cpu",kernelFunc:Nf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vf(o){const{inputs:s,backend:t}=o,{indices:n,values:e,denseShape:a,defaultValue:i}=s;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(n.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${n.shape}`);if(e.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${e.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const c=t.data.get(n.dataId).values,r=t.data.get(e.dataId).values,l=t.data.get(a.dataId).values,d=t.data.get(i.dataId).values[0],[u,p,f,m,g]=$c(c,n.shape,n.dtype,r,e.dtype,l,d);return[t.makeTensorInfo(p,n.dtype,u),t.makeTensorInfo([p[0]],e.dtype,f),t.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(h=>Number(h)))),t.makeTensorInfo([g.length],n.dtype,new Int32Array(g))]}const Cf={kernelName:Pr,backendName:"cpu",kernelFunc:vf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tf(o){const{inputs:s,backend:t}=o,{inputIndices:n,inputShape:e,newShape:a}=s;if(n.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${n.shape}`);if(e.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${e.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(t.data.get(e.dataId).values),c=t.data.get(n.dataId).values,r=Array.from(t.data.get(a.dataId).values),[l,d,u]=zc(c,n.shape,n.dtype,i,r);return[t.makeTensorInfo(d,n.dtype,l),t.makeTensorInfo([u.length],a.dtype,new Int32Array(u))]}const Mf={kernelName:Wr,backendName:"cpu",kernelFunc:Tf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ff(o){const{inputs:s,backend:t}=o,{data:n,indices:e,segmentIds:a}=s;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(e.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${e.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(e.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(n.dataId).values,c=t.data.get(e.dataId).values,r=t.data.get(a.dataId).values,[l,d]=us(i,n.shape,n.dtype,c,r,!0);return t.makeTensorInfo(d,n.dtype,l)}const Rf={kernelName:Ar,backendName:"cpu",kernelFunc:Ff};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Df(o){const{inputs:s,backend:t}=o,{data:n,indices:e,segmentIds:a}=s;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(e.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${e.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(e.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(n.dataId).values,c=t.data.get(e.dataId).values,r=t.data.get(a.dataId).values,[l,d]=us(i,n.shape,n.dtype,c,r);return t.makeTensorInfo(d,n.dtype,l)}const Vf={kernelName:$r,backendName:"cpu",kernelFunc:Df};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ef(o){const{inputs:s,backend:t,attrs:n}=o,{sparseIndices:e,sparseValues:a,defaultValue:i}=s,{outputShape:c}=n,{sliceRank:r,numUpdates:l,sliceSize:d,strides:u,outputSize:p}=Xn(a,e,c),f=!1,m=t.bufferSync(e);let g;switch(a.dtype){case"bool":{const h=t.bufferSync(a),I=Boolean(t.data.get(i.dataId).values[0]);g=Xt(m,h,c,p,d,l,r,u,I,f);break}case"float32":{const h=t.bufferSync(a),I=t.data.get(i.dataId).values[0];g=Xt(m,h,c,p,d,l,r,u,I,f);break}case"int32":{const h=t.bufferSync(a),I=t.data.get(i.dataId).values[0];g=Xt(m,h,c,p,d,l,r,u,I,f);break}case"string":{const h=t.bufferSync(a),I=Ke(t.data.get(i.dataId).values[0]);g=Xt(m,h,c,p,d,l,r,u,I,f);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return t.makeTensorInfo(c,g.dtype,g.values)}const Of={kernelName:zr,backendName:"cpu",kernelFunc:Ef};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pf(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{numOrSizeSplits:a,axis:i}=n,c=mt(i,e.shape)[0],r=Lr(e,a,c),l=new Array(e.shape.length).fill(0),d=e.shape.slice();return r.map(u=>{const p=[...d];p[c]=u;const f=Pt({inputs:{x:e},backend:t,attrs:{begin:l,size:p}});return l[c]+=u,f})}const Wf={kernelName:Hr,backendName:"cpu",kernelFunc:Pf};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Af={kernelName:_r,backendName:"cpu",kernelFunc:({inputs:o,backend:s})=>{const{x:t}=o,n=s;G(t,"square");const e=n.data.get(t.dataId).values,a=new Float32Array(e.length);for(let c=0;c<e.length;++c){const r=e[c];a[c]=r*r}return{dataId:n.write(a,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $f=Q(es,(o,s)=>{const t=s;return isNaN(o)?NaN:o>0?1:t.alpha}),zf={kernelName:es,backendName:"cpu",kernelFunc:$f};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hf(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{begin:a,end:i,strides:c,beginMask:r,endMask:l,ellipsisMask:d,newAxisMask:u,shrinkAxisMask:p}=n;G(e,"stridedSlice");const{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:h,isSimpleSlice:I,begin:k,end:x,strides:b}=Gr(e.shape,a,i,c,r,l,d,u,p);let y;if(g)y=nt({inputs:{x:e},backend:t,attrs:{shape:m}});else if(h||I){ut(e.shape.length>=1,()=>`Input must have rank at least 1, got: ${e.shape.length}`);const S=qr(k,x,b),N=Pt({inputs:{x:e},backend:t,attrs:{begin:k,size:S}});y=nt({inputs:{x:N},backend:t,attrs:{shape:m}}),t.disposeIntermediateTensorInfo(N)}else{const S=t.bufferSync(e),N=qc(f,S,b,k);y=t.makeTensorInfo(m,N.dtype,N.values)}return y}const Lf={kernelName:Br,backendName:"cpu",kernelFunc:Hf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _f(o){const{inputs:s,backend:t,attrs:n}=o,{separator:e,nGramWidths:a,leftPad:i,rightPad:c,padWidth:r,preserveShortSequences:l}=n,{data:d,dataSplits:u}=s,p=t.data.get(d.dataId).values,f=t.data.get(u.dataId).values,[m,g]=Uc(p,f,e,a,i,c,r,l);return[t.makeTensorInfo([m.length],"string",m),t.makeTensorInfo(u.shape,"int32",g)]}const Bf={kernelName:jr,backendName:"cpu",kernelFunc:_f};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gf(o){const{inputs:s,backend:t,attrs:n}=o,{skipEmpty:e}=n,{input:a,delimiter:i}=s;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const c=t.data.get(a.dataId).values,r=t.data.get(i.dataId).values[0],[l,d,u]=Xc(c,r,e),p=d.length;return[t.makeTensorInfo([p,2],"int32",l),t.makeTensorInfo([p],"string",d),t.makeTensorInfo([2],"int32",new Int32Array(u))]}const qf={kernelName:Ur,backendName:"cpu",kernelFunc:Gf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jf(o){const{inputs:s,backend:t,attrs:n}=o,{numBuckets:e}=n,{input:a}=s;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(e<=0)throw new Error("Number of buckets must be at least 1");const i=t.data.get(a.dataId).values,c=Yc(i,e);return t.makeTensorInfo(a.shape,"int32",c)}const Uf={kernelName:Kr,backendName:"cpu",kernelFunc:jf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kf=Q(ns,o=>Math.tan(o)),Xf={kernelName:ns,backendName:"cpu",kernelFunc:Kf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yf=Q(ss,o=>Math.tanh(o)),Zf={kernelName:ss,backendName:"cpu",kernelFunc:Yf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qf(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{reps:a}=n;G(e,"tile");const i=tl(t.bufferSync(e),a);return t.makeTensorInfo(i.shape,i.dtype,i.values)}const Jf={kernelName:Xr,backendName:"cpu",kernelFunc:Qf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function th(o){const{inputs:s,backend:t,attrs:n}=o,{x:e}=s,{k:a,sorted:i}=n;G(e,"topk");const c=t.data.get(e.dataId).values,[r,l]=el(c,e.shape,e.dtype,a,i);return[t.makeTensorInfo(r.shape,r.dtype,r.values),t.makeTensorInfo(l.shape,l.dtype,l.values)]}const eh={kernelName:Yr,backendName:"cpu",kernelFunc:th};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nh(o){const{inputs:s,attrs:t,backend:n}=o,{image:e,transforms:a}=s,{interpolation:i,fillMode:c,fillValue:r,outputShape:l}=t,[d,u,p,f]=e.shape,[m,g]=l??[u,p],h=[d,m,g,f],I=K(e.shape),k=I[0],x=I[1],b=I[2],y=K(h),S=y[0],N=y[1],w=y[2],F=ft(e.dtype,B(h));F.fill(r);const R=n.data.get(e.dataId).values,E=n.data.get(a.dataId).values;for(let v=0;v<d;++v){const D=a.shape[0]===1?E:E.subarray(v*8,v*8+8);for(let C=0;C<m;++C)for(let T=0;T<g;++T)for(let O=0;O<f;++O){let M;const V=D[6]*T+D[7]*C+1;if(V===0)continue;const A=(D[0]*T+D[1]*C+D[2])/V,W=(D[3]*T+D[4]*C+D[5])/V,H=Ue(A,p,c),$=Ue(W,u,c);switch(i){case"nearest":M=ch(R,u,p,k,x,b,v,$,H,O,r);break;case"bilinear":M=lh(R,u,p,k,x,b,v,$,H,O,r);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const L=v*S+C*N+T*w+O;F[L]=M}return n.makeTensorInfo(h,e.dtype,F)}return{dataId:n.write(F,h,e.dtype),shape:e.shape,dtype:e.dtype}}const sh={kernelName:Zr,backendName:"cpu",kernelFunc:nh};function Ue(o,s,t){switch(t){case"reflect":return ah(o,s);case"wrap":return oh(o,s);case"nearest":return ih(o,s);case"constant":default:return rh(o)}}function ah(o,s){let t=o;if(t<0)if(s<=1)t=0;else{const n=2*s;t<n&&(t=n*Math.trunc(-t/n)+t),t=t<-s?t+n:-t-1}else if(t>s-1)if(s<=1)t=0;else{const n=2*s;t-=n*Math.trunc(t/n),t>=s&&(t=n-t-1)}return Re(0,t,s-1)}function oh(o,s){let t=o;if(t<0)if(s<=1)t=0;else{const n=s-1;t+=s*(Math.trunc(-t/n)+1)}else if(t>s-1)if(s<=1)t=0;else{const n=s-1;t-=s*Math.trunc(t/n)}return Re(0,t,s-1)}function rh(o,s){return o}function ih(o,s){return Re(0,o,s-1)}function Zt(o,s,t,n,e,a,i,c,r,l,d){const u=i*n+c*e+r*a+l;return 0<=c&&c<s&&0<=r&&r<t?o[u]:d}function ch(o,s,t,n,e,a,i,c,r,l,d){const u=Math.round(c),p=Math.round(r);return Zt(o,s,t,n,e,a,i,u,p,l,d)}function lh(o,s,t,n,e,a,i,c,r,l,d){const u=Math.floor(c),p=Math.floor(r),f=u+1,m=p+1,g=(m-r)*Zt(o,s,t,n,e,a,i,u,p,l,d)+(r-p)*Zt(o,s,t,n,e,a,i,u,m,l,d),h=(m-r)*Zt(o,s,t,n,e,a,i,f,p,l,d)+(r-p)*Zt(o,s,t,n,e,a,i,f,m,l,d);return(f-c)*g+(c-u)*h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dh(o){const{inputs:s,attrs:t,backend:n}=o,{axis:e}=t,{x:a}=s;G(a,"unique");const i=n.data.get(a.dataId).values,{outputValues:c,outputShape:r,indices:l}=nl(i,e,a.shape,a.dtype);return[n.makeTensorInfo(r,a.dtype,c),n.makeTensorInfo([l.length],"int32",l)]}const uh={kernelName:Qr,backendName:"cpu",kernelFunc:dh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ph(o){const{inputs:s,backend:t,attrs:n}=o,{value:e}=s;let{axis:a}=n;a<0&&(a+=e.shape.length);const i=e.shape.length,c=e.shape[a],r=new Array(i-1);let l=0;for(let f=0;f<i;f++)f!==a&&(r[l++]=e.shape[f]);const d=new Array(i).fill(0),u=e.shape.slice();u[a]=1;const p=new Array(c);for(let f=0;f<p.length;f++){d[a]=f;const m=Pt({inputs:{x:e},backend:t,attrs:{begin:d,size:u}});p[f]=nt({inputs:{x:m},backend:t,attrs:{shape:r}}),t.disposeIntermediateTensorInfo(m)}return p}const fh={kernelName:Jr,backendName:"cpu",kernelFunc:ph};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hh(o){const{inputs:s,backend:t,attrs:n}=o,{x:e,segmentIds:a}=s,{numSegments:i}=n;G(e,"unsortedSegmentSum");const c=e.shape.length,r=a.shape.length,l=[],d=[],u=c-r;let p=a;for(let m=0;m<u;++m){const g=ce({inputs:{input:p},backend:t,attrs:{dim:m+1}});p=g,d.push(g)}for(let m=0;m<i;++m){const g=we(m,"int32"),h=t.makeTensorInfo([],"int32",g),I=rs({inputs:{a:h,b:p},backend:t}),k=Vt({inputs:{x:I},backend:t,attrs:{dtype:"float32"}}),x=me({inputs:{a:k,b:e},backend:t}),b=te({inputs:{x},backend:t,attrs:{axis:0,keepDims:!1}});l.push(b),d.push(h),d.push(I),d.push(k),d.push(x),d.push(b)}const f=Ts({inputs:l,backend:t,attrs:{axis:0}});return d.forEach(m=>t.disposeIntermediateTensorInfo(m)),f}const mh={kernelName:ti,backendName:"cpu",kernelFunc:hh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gh=[pl,gi,hl,gl,wi,kl,xl,Sl,wl,Cl,Ml,Rl,Vl,Pl,Al,Hl,_l,Gl,jl,dl,Kl,Yl,Ql,td,yi,Mi,nd,Ii,ad,rd,id,ld,ud,fd,md,Id,bd,yd,Nd,vd,Td,Fd,Dd,Vd,Od,Wd,$d,zd,Hd,Ld,Gd,sl,jd,Di,tu,Ei,eu,Wi,iu,cu,du,zi,fu,mu,Iu,bu,yu,Gi,Ui,ki,Nu,od,vu,Tu,Fu,al,Yi,Ji,Du,sc,Eu,Wu,$u,Lu,Bu,qu,ju,ic,Ku,Yu,Qu,tp,np,ap,rp,dc,cp,up,hp,pc,mc,Ip,xp,Np,kc,vp,Tp,Mp,Ms,Vp,rl,Sc,Op,Wp,$p,bi,Se,Hp,il,cl,ll,_p,Gp,jp,Kp,Yp,Zp,Jp,Oc,ef,rf,lf,ff,Pc,mf,If,bf,Ac,pp,Sf,wf,Cf,Mf,Rf,Vf,Of,Wf,Lc,Af,Gc,zf,Lf,Bf,qf,Uf,Jc,_d,Xf,Zf,Jf,eh,sh,bc,uh,fh,mh,Cp];for(const o of gh)ei(o);var de={},Ih={get exports(){return de},set exports(o){de=o}};const kh=as(pi),bh=as(ni);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(function(o,s){(function(t,n){n(s,kh,bh)})(si,function(t,n,e){const a={1:{name:"/m/01g317",id:1,displayName:"person"},2:{name:"/m/0199g",id:2,displayName:"bicycle"},3:{name:"/m/0k4j",id:3,displayName:"car"},4:{name:"/m/04_sv",id:4,displayName:"motorcycle"},5:{name:"/m/05czz6l",id:5,displayName:"airplane"},6:{name:"/m/01bjv",id:6,displayName:"bus"},7:{name:"/m/07jdr",id:7,displayName:"train"},8:{name:"/m/07r04",id:8,displayName:"truck"},9:{name:"/m/019jd",id:9,displayName:"boat"},10:{name:"/m/015qff",id:10,displayName:"traffic light"},11:{name:"/m/01pns0",id:11,displayName:"fire hydrant"},13:{name:"/m/02pv19",id:13,displayName:"stop sign"},14:{name:"/m/015qbp",id:14,displayName:"parking meter"},15:{name:"/m/0cvnqh",id:15,displayName:"bench"},16:{name:"/m/015p6",id:16,displayName:"bird"},17:{name:"/m/01yrx",id:17,displayName:"cat"},18:{name:"/m/0bt9lr",id:18,displayName:"dog"},19:{name:"/m/03k3r",id:19,displayName:"horse"},20:{name:"/m/07bgp",id:20,displayName:"sheep"},21:{name:"/m/01xq0k1",id:21,displayName:"cow"},22:{name:"/m/0bwd_0j",id:22,displayName:"elephant"},23:{name:"/m/01dws",id:23,displayName:"bear"},24:{name:"/m/0898b",id:24,displayName:"zebra"},25:{name:"/m/03bk1",id:25,displayName:"giraffe"},27:{name:"/m/01940j",id:27,displayName:"backpack"},28:{name:"/m/0hnnb",id:28,displayName:"umbrella"},31:{name:"/m/080hkjn",id:31,displayName:"handbag"},32:{name:"/m/01rkbr",id:32,displayName:"tie"},33:{name:"/m/01s55n",id:33,displayName:"suitcase"},34:{name:"/m/02wmf",id:34,displayName:"frisbee"},35:{name:"/m/071p9",id:35,displayName:"skis"},36:{name:"/m/06__v",id:36,displayName:"snowboard"},37:{name:"/m/018xm",id:37,displayName:"sports ball"},38:{name:"/m/02zt3",id:38,displayName:"kite"},39:{name:"/m/03g8mr",id:39,displayName:"baseball bat"},40:{name:"/m/03grzl",id:40,displayName:"baseball glove"},41:{name:"/m/06_fw",id:41,displayName:"skateboard"},42:{name:"/m/019w40",id:42,displayName:"surfboard"},43:{name:"/m/0dv9c",id:43,displayName:"tennis racket"},44:{name:"/m/04dr76w",id:44,displayName:"bottle"},46:{name:"/m/09tvcd",id:46,displayName:"wine glass"},47:{name:"/m/08gqpm",id:47,displayName:"cup"},48:{name:"/m/0dt3t",id:48,displayName:"fork"},49:{name:"/m/04ctx",id:49,displayName:"knife"},50:{name:"/m/0cmx8",id:50,displayName:"spoon"},51:{name:"/m/04kkgm",id:51,displayName:"bowl"},52:{name:"/m/09qck",id:52,displayName:"banana"},53:{name:"/m/014j1m",id:53,displayName:"apple"},54:{name:"/m/0l515",id:54,displayName:"sandwich"},55:{name:"/m/0cyhj_",id:55,displayName:"orange"},56:{name:"/m/0hkxq",id:56,displayName:"broccoli"},57:{name:"/m/0fj52s",id:57,displayName:"carrot"},58:{name:"/m/01b9xk",id:58,displayName:"hot dog"},59:{name:"/m/0663v",id:59,displayName:"pizza"},60:{name:"/m/0jy4k",id:60,displayName:"donut"},61:{name:"/m/0fszt",id:61,displayName:"cake"},62:{name:"/m/01mzpv",id:62,displayName:"chair"},63:{name:"/m/02crq1",id:63,displayName:"couch"},64:{name:"/m/03fp41",id:64,displayName:"potted plant"},65:{name:"/m/03ssj5",id:65,displayName:"bed"},67:{name:"/m/04bcr3",id:67,displayName:"dining table"},70:{name:"/m/09g1w",id:70,displayName:"toilet"},72:{name:"/m/07c52",id:72,displayName:"tv"},73:{name:"/m/01c648",id:73,displayName:"laptop"},74:{name:"/m/020lf",id:74,displayName:"mouse"},75:{name:"/m/0qjjc",id:75,displayName:"remote"},76:{name:"/m/01m2v",id:76,displayName:"keyboard"},77:{name:"/m/050k8",id:77,displayName:"cell phone"},78:{name:"/m/0fx9l",id:78,displayName:"microwave"},79:{name:"/m/029bxz",id:79,displayName:"oven"},80:{name:"/m/01k6s3",id:80,displayName:"toaster"},81:{name:"/m/0130jx",id:81,displayName:"sink"},82:{name:"/m/040b_t",id:82,displayName:"refrigerator"},84:{name:"/m/0bt_c3",id:84,displayName:"book"},85:{name:"/m/01x3z",id:85,displayName:"clock"},86:{name:"/m/02s195",id:86,displayName:"vase"},87:{name:"/m/01lsmm",id:87,displayName:"scissors"},88:{name:"/m/0kmg4",id:88,displayName:"teddy bear"},89:{name:"/m/03wvsk",id:89,displayName:"hair drier"},90:{name:"/m/012xff",id:90,displayName:"toothbrush"}};class i{constructor(r,l){this.modelPath=l||`https://storage.googleapis.com/tfjs-models/savedmodel/${this.getPrefix(r)}/model.json`}getPrefix(r){return r==="lite_mobilenet_v2"?`ssd${r}`:`ssd_${r}`}async load(){this.model=await n.loadGraphModel(this.modelPath);const r=e.zeros([1,300,300,3],"int32"),l=await this.model.executeAsync(r);await Promise.all(l.map(d=>d.data())),l.map(d=>d.dispose()),r.dispose()}async infer(r,l,d){const u=e.tidy(()=>(r instanceof e.Tensor||(r=e.browser.fromPixels(r)),e.expandDims(r))),p=u.shape[1],f=u.shape[2],m=await this.model.executeAsync(u),g=m[0].dataSync(),h=m[1].dataSync();u.dispose(),e.dispose(m);const[I,k]=this.calculateMaxScores(g,m[0].shape[1],m[0].shape[2]),x=e.getBackend();e.getBackend()==="webgl"&&e.setBackend("cpu");const b=e.tidy(()=>{const S=e.tensor2d(h,[m[1].shape[1],m[1].shape[3]]);return e.image.nonMaxSuppression(S,I,l,d,d)}),y=b.dataSync();return b.dispose(),x!==e.getBackend()&&e.setBackend(x),this.buildDetectedObjects(f,p,h,I,y,k)}buildDetectedObjects(r,l,d,u,p,f){const m=p.length,g=[];for(let h=0;h<m;h++){const I=[];for(let S=0;S<4;S++)I[S]=d[4*p[h]+S];const k=I[0]*l,x=I[1]*r,b=I[2]*l,y=I[3]*r;I[0]=x,I[1]=k,I[2]=y-x,I[3]=b-k,g.push({bbox:I,class:a[f[p[h]]+1].displayName,score:u[p[h]]})}return g}calculateMaxScores(r,l,d){const u=[],p=[];for(let f=0;f<l;f++){let m=Number.MIN_VALUE,g=-1;for(let h=0;h<d;h++)r[f*d+h]>m&&(m=r[f*d+h],g=h);u[f]=m,p[f]=g}return[u,p]}async detect(r,l=20,d=.5){return this.infer(r,l,d)}dispose(){this.model!=null&&this.model.dispose()}}t.ObjectDetection=i,t.load=async function(c={}){if(e==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");const r=c.base||"lite_mobilenet_v2",l=c.modelUrl;if(["mobilenet_v1","mobilenet_v2","lite_mobilenet_v2"].indexOf(r)===-1)throw new Error(`ObjectDetection constructed with invalid base model ${r}. Valid names are 'mobilenet_v1', 'mobilenet_v2' and 'lite_mobilenet_v2'.`);const d=new i(r,l);return await d.load(),d},t.version="2.2.2",Object.defineProperty(t,"__esModule",{value:!0})})})(Ih,de);const xh={class:"coco-ssd"},yh=ii({__name:"CocoSsd",setup(o){const s={person:"人",bicycle:"自行车",car:"汽车",motorcycle:"摩托车",airplane:"飞机",bus:"公共汽车",train:"火车",truck:"卡车",boat:"船","traffic light":"交通灯","fire hydrant":"消防栓","stop sign":"停车标志","parking meter":"停车计时器",bench:"长凳",bird:"鸟",cat:"猫",dog:"狗",horse:"马",sheep:"绵羊",cow:"牛",elephant:"大象",bear:"熊",zebra:"斑马",giraffe:"长颈鹿",backpack:"背包",umbrella:"雨伞",handbag:"手提包",tie:"领带",suitcase:"手提箱",frisbee:"飞盘",skis:"滑雪板",snowboard:"滑雪板","sports ball":"运动球",kite:"风筝","baseball bat":"棒球棒","baseball glove":"棒球手套",skateboard:"滑板",surfboard:"冲浪板","tennis racket":"网球拍",bottle:"瓶子","wine glass":"酒杯",cup:"杯子",fork:"叉子",knife:"刀",spoon:"勺子",bowl:"碗",banana:"香蕉",apple:"苹果",sandwich:"三明治",orange:"橙子",broccoli:"西兰花",carrot:"胡萝卜","hot dog":"热狗",pizza:"披萨",donut:"甜甜圈",cake:"蛋糕",chair:"椅子",couch:"沙发","potted plant":"盆栽植物",bed:"床","dining table":"餐桌",toilet:"厕所",tv:"电视",laptop:"笔记本电脑",mouse:"老鼠",remote:"遥控器",keyboard:"键盘","cell phone":"手机",microwave:"微波炉",oven:"烤箱",toaster:"烤面包机",sink:"接收器",refrigerator:"冰箱",book:"书",clock:"时钟",vase:"花瓶",scissors:"剪刀","teddy bear":"泰迪熊","hair drier":"吹风机",toothbrush:"牙刷"},t=be(),n=be(),e=be(!1);async function a(){if(!i.status)return;l(r.value);const m=d();(await f.detect(m)).forEach(h=>{const{bbox:I,class:k,score:x}=h;u(I,"rgba(64, 158, 255, 0.5)"),p({text:`${s[k]}：${x}`,bbox:I,style:"#fff"})}),window.requestAnimationFrame(a)}const{videoConfig:i,videoButtonClick:c,newVideoRef:r}=ri({videoRef:t,videoProceed:a}),{drawImage:l,getImageData:d,fillRect:u,drawText:p}=oi({canvasRef:n});let f;return ci(async()=>{f=await de.load(),e.value=!0}),(m,g)=>(_e(),Le("div",xh,[xe("div",null,[xe("video",{ref_key:"videoRef",ref:t,autoplay:""},null,512),xe("canvas",{ref_key:"canvasRef",ref:n},null,512)]),e.value?(_e(),Le("button",{key:0,onClick:g[0]||(g[0]=(...h)=>ye(c)&&ye(c)(...h))},li(ye(i).status?"关闭":"开启")+"摄像头 ",1)):di("",!0)]))}});const Ch=ai(yh,[["__scopeId","data-v-86b0cb75"]]);export{Ch as default};
